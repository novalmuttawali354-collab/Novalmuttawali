<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TRANSFORMER LEADERBOARD - LC AUDIT</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #00f3ff; /* Cyan neon */
            --secondary: #ff00ff; /* Magenta neon */
            --accent: #00ff9d; /* Green neon */
            --warning: #ffaa00; /* Amber */
            --dark: #0a0a0a; /* Almost black */
            --darker: #000000; /* Pure black */
            --light: #ffffff;
            --metal: #c0c0c0;
            --gold: #ffd700;
            --silver: #c0c0c0;
            --bronze: #cd7f32;
            
            /* Glow colors */
            --cyan-glow: rgba(0, 243, 255, 0.8);
            --magenta-glow: rgba(255, 0, 255, 0.8);
            --green-glow: rgba(0, 255, 157, 0.8);
            --amber-glow: rgba(255, 170, 0, 0.8);
            
            /* Gradients */
            --cyber-gradient: linear-gradient(45deg, #00f3ff, #ff00ff, #00ff9d);
            --matrix-gradient: linear-gradient(90deg, #00ff9d, #00f3ff, #ff00ff);
            --metal-gradient: linear-gradient(135deg, #1a1a1a, #333333, #1a1a1a);
            
            /* Shadows */
            --neon-shadow: 0 0 10px var(--cyan-glow), 0 0 20px var(--cyan-glow), 0 0 30px var(--cyan-glow);
            --magenta-shadow: 0 0 10px var(--magenta-glow), 0 0 20px var(--magenta-glow), 0 0 30px var(--magenta-glow);
            --green-shadow: 0 0 10px var(--green-glow), 0 0 20px var(--green-glow), 0 0 30px var(--green-glow);
            --amber-shadow: 0 0 10px var(--amber-glow), 0 0 20px var(--amber-glow), 0 0 30px var(--amber-glow);
            
            /* Card colors */
            --card-bg: rgba(26, 26, 26, 0.85);
            --card-border: rgba(0, 243, 255, 0.3);
            --card-hover-bg: rgba(38, 38, 38, 0.9);
            --error-bg: rgba(255, 50, 50, 0.2);
            --error-color: #ff5555;
            --warning-bg: rgba(255, 170, 0, 0.2);
            --warning-color: #ffaa00;
            --info-bg: rgba(0, 243, 255, 0.2);
            --info-color: #00f3ff;
            --success-bg: rgba(0, 255, 157, 0.2);
            --success-color: #00ff9d;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Roboto', 'Arial', sans-serif;
        }
        
        body {
            background: var(--darker);
            color: var(--light);
            min-height: 100vh;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
            background-image: 
                linear-gradient(to right, rgba(0, 243, 255, 0.05) 1px, transparent 1px),
                linear-gradient(to bottom, rgba(0, 243, 255, 0.05) 1px, transparent 1px);
            background-size: 40px 40px;
        }
        
        /* Digital Grid Background */
        .cyber-grid {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                linear-gradient(90deg, transparent 49%, rgba(0, 243, 255, 0.1) 50%, transparent 51%),
                linear-gradient(0deg, transparent 49%, rgba(0, 243, 255, 0.1) 50%, transparent 51%);
            background-size: 100px 100px;
            z-index: -3;
            animation: gridPulse 10s ease-in-out infinite;
        }
        
        @keyframes gridPulse {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 0.7; }
        }
        
        /* Animated scan lines */
        .scan-lines {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                to bottom,
                transparent 95%,
                rgba(0, 243, 255, 0.1) 100%
            );
            background-size: 100% 4px;
            z-index: -2;
            pointer-events: none;
            animation: scan 8s linear infinite;
        }
        
        @keyframes scan {
            0% { transform: translateY(0); }
            100% { transform: translateY(100vh); }
        }
        
        /* Hexagon pattern */
        .hex-pattern {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M50 0L93.3 25V75L50 100L6.7 75V25L50 0Z' fill='none' stroke='rgba(0, 243, 255, 0.1)' stroke-width='0.5'/%3E%3C/svg%3E");
            background-size: 100px 100px;
            z-index: -2;
            opacity: 0.5;
        }
        
        /* Digital particles */
        .digital-particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: -1;
        }
        
        .digital-particle {
            position: absolute;
            background: var(--primary);
            border-radius: 2px;
            animation: digitalFloat 20s linear infinite;
            opacity: 0;
        }
        
        @keyframes digitalFloat {
            0% {
                transform: translateY(100vh) translateX(0) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 0.8;
            }
            90% {
                opacity: 0.8;
            }
            100% {
                transform: translateY(-100vh) translateX(100px) rotate(360deg);
                opacity: 0;
            }
        }
        
        /* Laser beams */
        .laser-beams {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            pointer-events: none;
        }
        
        .laser-beam {
            position: absolute;
            width: 2px;
            height: 100%;
            background: linear-gradient(to bottom, 
                transparent, 
                var(--primary), 
                var(--secondary), 
                var(--primary), 
                transparent);
            animation: laserSweep 6s ease-in-out infinite;
            opacity: 0.5;
            filter: blur(1px);
        }
        
        @keyframes laserSweep {
            0%, 100% { transform: translateX(-100%) rotate(15deg); opacity: 0; }
            10%, 90% { opacity: 0.5; }
            50% { transform: translateX(200%) rotate(15deg); }
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }
        
        header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            background: rgba(10, 10, 10, 0.8);
            border: 1px solid var(--card-border);
            border-radius: 20px;
            box-shadow: var(--neon-shadow);
            animation: headerGlow 4s ease-in-out infinite alternate;
            position: relative;
            overflow: hidden;
        }
        
        @keyframes headerGlow {
            0% { box-shadow: 0 0 20px rgba(0, 243, 255, 0.5); }
            50% { box-shadow: 0 0 30px rgba(255, 0, 255, 0.5); }
            100% { box-shadow: 0 0 20px rgba(0, 255, 157, 0.5); }
        }
        
        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(0, 243, 255, 0.1), 
                rgba(255, 0, 255, 0.1), 
                rgba(0, 255, 157, 0.1), 
                transparent);
            animation: headerShimmer 3s infinite;
        }
        
        @keyframes headerShimmer {
            100% { left: 100%; }
        }
        
        h1 {
            font-size: 3.5rem;
            margin-bottom: 15px;
            background: var(--cyber-gradient);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-transform: uppercase;
            letter-spacing: 2px;
            font-weight: 900;
            text-shadow: 0 0 30px rgba(0, 243, 255, 0.5);
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
        }
        
        h1 i {
            font-size: 3rem;
            animation: iconPulse 2s ease-in-out infinite;
        }
        
        @keyframes iconPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        .subtitle {
            font-size: 1.3rem;
            color: var(--metal);
            font-weight: 300;
            letter-spacing: 1px;
            text-transform: uppercase;
            margin-top: 10px;
        }
        
        /* Digital circuit line under title */
        .circuit-line {
            height: 4px;
            background: var(--cyber-gradient);
            margin: 20px auto;
            max-width: 400px;
            border-radius: 2px;
            position: relative;
            overflow: hidden;
        }
        
        .circuit-line::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 255, 255, 0.8), 
                transparent);
            animation: circuitFlow 2s infinite;
        }
        
        @keyframes circuitFlow {
            100% { left: 100%; }
        }
        
        /* LED indicators */
        .led-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 10px;
            animation: ledBlink 2s infinite;
        }
        
        .led-green {
            background: var(--accent);
            box-shadow: 0 0 10px var(--accent);
        }
        
        .led-cyan {
            background: var(--primary);
            box-shadow: 0 0 10px var(--primary);
        }
        
        .led-magenta {
            background: var(--secondary);
            box-shadow: 0 0 10px var(--secondary);
        }
        
        .led-amber {
            background: var(--warning);
            box-shadow: 0 0 10px var(--warning);
        }
        
        @keyframes ledBlink {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 1; }
        }
        
        .card {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            border-radius: 15px;
            border: 1px solid var(--card-border);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            overflow: hidden;
            margin-bottom: 30px;
            animation: cardAppear 0.8s ease;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .card::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: var(--cyber-gradient);
            border-radius: 17px;
            z-index: -1;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .card:hover::before {
            opacity: 1;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 243, 255, 0.3);
        }
        
        @keyframes cardAppear {
            from {
                opacity: 0;
                transform: translateY(30px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        
        .card-header {
            background: rgba(0, 0, 0, 0.7);
            padding: 25px;
            text-align: center;
            border-bottom: 1px solid var(--card-border);
            position: relative;
            overflow: hidden;
        }
        
        .card-header h2 {
            font-size: 1.8rem;
            color: var(--primary);
            text-transform: uppercase;
            letter-spacing: 1px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }
        
        .card-header::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: var(--cyber-gradient);
            animation: gradientShift 3s ease infinite;
        }
        
        @keyframes gradientShift {
            0%, 100% { background: linear-gradient(90deg, var(--primary), var(--secondary)); }
            50% { background: linear-gradient(90deg, var(--secondary), var(--accent)); }
        }
        
        .card-body {
            padding: 30px;
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.1rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        input {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid rgba(0, 243, 255, 0.3);
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s;
            background: rgba(0, 0, 0, 0.6);
            color: var(--light);
            font-family: 'Courier New', monospace;
            letter-spacing: 1px;
        }
        
        input::placeholder {
            color: rgba(255, 255, 255, 0.5);
            font-family: 'Segoe UI', sans-serif;
        }
        
        input:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 20px rgba(0, 243, 255, 0.5);
            background: rgba(0, 0, 0, 0.8);
        }
        
        .btn-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .btn {
            background: rgba(0, 0, 0, 0.7);
            color: var(--light);
            border: 2px solid transparent;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            position: relative;
            overflow: hidden;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-family: 'Roboto', sans-serif;
        }
        
        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(0, 243, 255, 0.3), 
                transparent);
            transition: left 0.7s;
        }
        
        .btn:hover::before {
            left: 100%;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            border-color: var(--primary);
            box-shadow: 0 10px 20px rgba(0, 243, 255, 0.3);
        }
        
        #fetchData {
            background: linear-gradient(45deg, rgba(0, 243, 255, 0.2), rgba(0, 255, 157, 0.2));
            border-color: var(--accent);
        }
        
        #refreshData {
            background: linear-gradient(45deg, rgba(255, 0, 255, 0.2), rgba(0, 243, 255, 0.2));
            border-color: var(--secondary);
        }
        
        .btn:disabled {
            background: #333;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
            border-color: #666;
        }
        
        .message {
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            text-align: center;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 10px;
            animation: slideIn 0.5s ease;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        .error {
            background: var(--error-bg);
            color: var(--error-color);
            border-left: 4px solid var(--error-color);
        }
        
        .success {
            background: var(--success-bg);
            color: var(--success-color);
            border-left: 4px solid var(--success-color);
        }
        
        .warning {
            background: var(--warning-bg);
            color: var(--warning-color);
            border-left: 4px solid var(--warning-color);
        }
        
        .info {
            background: var(--info-bg);
            color: var(--info-color);
            border-left: 4px solid var(--info-color);
        }
        
        .loading {
            text-align: center;
            padding: 30px;
            color: var(--light);
        }
        
        .spinner {
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top: 4px solid var(--primary);
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Tab Navigation */
        .tab-navigation {
            display: flex;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 15px 15px 0 0;
            overflow: hidden;
            margin-bottom: 0;
            border: 1px solid var(--card-border);
            border-bottom: none;
            position: relative;
        }
        
        .tab-button {
            flex: 1;
            padding: 20px;
            background: transparent;
            color: rgba(255, 255, 255, 0.7);
            border: none;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .tab-button:hover {
            background: rgba(0, 243, 255, 0.1);
            color: var(--primary);
        }
        
        .tab-button.active {
            background: rgba(0, 243, 255, 0.2);
            color: var(--primary);
            border-bottom: 3px solid var(--primary);
        }
        
        .tab-button i {
            font-size: 1.1rem;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
            animation: fadeInUp 0.5s ease;
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* Leaderboard table */
        .leaderboard {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            overflow: hidden;
            border-radius: 10px;
            border: 1px solid rgba(0, 243, 255, 0.3);
        }
        
        .leaderboard th {
            background: rgba(0, 0, 0, 0.8);
            color: var(--primary);
            padding: 20px;
            text-align: left;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            border-bottom: 2px solid var(--primary);
        }
        
        .leaderboard tr {
            border-bottom: 1px solid rgba(0, 243, 255, 0.1);
            transition: all 0.3s;
            background: rgba(20, 20, 20, 0.7);
        }
        
        .leaderboard tr:hover {
            background: rgba(0, 243, 255, 0.1);
            transform: scale(1.01);
            box-shadow: 0 0 20px rgba(0, 243, 255, 0.2);
        }
        
        .leaderboard td {
            padding: 20px;
            color: var(--metal);
            font-weight: 500;
        }
        
        .rank {
            font-weight: bold;
            text-align: center;
            width: 60px;
        }
        
        /* Medal colors */
        .gold-medal {
            color: var(--gold);
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }
        
        .silver-medal {
            color: var(--silver);
            text-shadow: 0 0 10px rgba(192, 192, 192, 0.5);
        }
        
        .bronze-medal {
            color: var(--bronze);
            text-shadow: 0 0 10px rgba(205, 127, 50, 0.5);
        }
        
        /* Bonus clickable */
        .bonus-clickable {
            cursor: pointer;
            transition: all 0.3s;
            padding: 5px 10px;
            border-radius: 5px;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }
        
        .bonus-clickable:hover {
            background: rgba(0, 243, 255, 0.1);
            transform: scale(1.05);
        }
        
        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(5px);
            animation: fadeIn 0.3s ease;
        }
        
        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .modal-content {
            background: rgba(10, 10, 10, 0.95);
            backdrop-filter: blur(20px);
            border: 2px solid var(--primary);
            border-radius: 20px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            box-shadow: 
                0 0 50px rgba(0, 243, 255, 0.5),
                inset 0 0 20px rgba(0, 243, 255, 0.1);
            animation: slideUp 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        @keyframes slideUp {
            from {
                transform: translateY(50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
        
        .modal-header {
            text-align: center;
            margin-bottom: 25px;
        }
        
        .modal-title {
            font-size: 1.8rem;
            color: var(--primary);
            margin-bottom: 10px;
            text-shadow: 0 0 10px rgba(0, 243, 255, 0.5);
        }
        
        .modal-subtitle {
            color: rgba(255, 255, 255, 0.8);
            font-size: 1rem;
        }
        
        .modal-body {
            text-align: center;
        }
        
        .bonus-display {
            background: rgba(0, 243, 255, 0.1);
            border: 2px solid var(--primary);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            position: relative;
        }
        
        .bonus-label {
            color: var(--primary);
            font-size: 1.1rem;
            margin-bottom: 10px;
            font-weight: 600;
        }
        
        .bonus-value {
            font-size: 3rem;
            color: var(--accent);
            font-weight: 900;
            text-shadow: 
                0 0 20px var(--accent),
                0 0 40px var(--accent);
            animation: bonusGlow 2s ease-in-out infinite alternate;
        }
        
        @keyframes bonusGlow {
            from { text-shadow: 0 0 20px var(--accent); }
            to { text-shadow: 0 0 30px var(--accent), 0 0 50px var(--accent); }
        }
        
        .motivational-message {
            background: rgba(255, 0, 255, 0.1);
            border-left: 4px solid var(--secondary);
            padding: 15px;
            margin: 20px 0;
            border-radius: 10px;
            text-align: center;
        }
        
        .motivational-message p {
            color: var(--light);
            font-size: 1.1rem;
            line-height: 1.6;
            font-style: italic;
        }
        
        .modal-footer {
            margin-top: 25px;
            text-align: center;
        }
        
        .close-btn {
            background: linear-gradient(45deg, rgba(0, 243, 255, 0.2), rgba(0, 255, 157, 0.2));
            color: var(--light);
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .close-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 0 20px rgba(0, 243, 255, 0.5);
        }
        
        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background: var(--accent);
            animation: confetti-fall 3s linear;
        }
        
        @keyframes confetti-fall {
            0% {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }
        
        /* CS LINE Section */
        .cs-section {
            background: rgba(0, 0, 0, 0.7);
            border: 1px solid var(--secondary);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 0 30px rgba(255, 0, 255, 0.2);
            position: relative;
            overflow: hidden;
        }
        
        .cs-section::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: var(--matrix-gradient);
        }
        
        .cs-header {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            margin-bottom: 20px;
            color: var(--accent);
            font-size: 1.5rem;
            font-weight: bold;
            text-align: center;
        }
        
        .cs-header i {
            font-size: 1.8rem;
            animation: pulse 2s infinite;
        }
        
        .cs-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .cs-card {
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 0 15px rgba(255, 0, 255, 0.2);
            border-left: 4px solid var(--accent);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .cs-card::after {
            content: "";
            position: absolute;
            top: 0;
            right: 0;
            width: 60px;
            height: 60px;
            background: var(--matrix-gradient);
            opacity: 0.1;
            border-radius: 0 0 0 60px;
        }
        
        .cs-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 0 25px rgba(0, 243, 255, 0.3);
            background: rgba(0, 0, 0, 0.7);
        }
        
        .cs-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--matrix-gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            color: var(--light);
            font-size: 1.5rem;
            font-weight: bold;
        }
        
        .cs-name {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--light);
            text-align: center;
            margin-bottom: 10px;
        }
        
        .cs-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-top: 1px solid rgba(0, 243, 255, 0.1);
        }
        
        .cs-label {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.7);
        }
        
        .cs-value {
            font-weight: 600;
            color: var(--accent);
        }
        
        .cs-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: var(--matrix-gradient);
            color: var(--light);
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .cs-status {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
        }
        
        .cs-status.valid {
            background: rgba(0, 255, 157, 0.2);
            color: var(--accent);
        }
        
        .cs-status.error {
            background: var(--error-bg);
            color: var(--error-color);
        }
        
        /* Ranking styles */
        .top-1 {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.3), rgba(255, 215, 0, 0.1));
            border-left: 5px solid var(--gold);
            font-weight: bold;
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.3);
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }
        
        .top-1 .rank {
            color: var(--gold);
            font-size: 1.2rem;
        }
        
        .top-2 {
            background: linear-gradient(135deg, rgba(192, 192, 192, 0.3), rgba(192, 192, 192, 0.1));
            border-left: 5px solid var(--silver);
        }
        
        .top-2 .rank {
            color: var(--silver);
        }
        
        .top-3 {
            background: linear-gradient(135deg, rgba(205, 127, 50, 0.3), rgba(205, 127, 50, 0.1));
            border-left: 5px solid var(--bronze);
        }
        
        .top-3 .rank {
            color: var(--bronze);
        }
        
        .has-error {
            background: var(--error-bg);
            border-left: 5px solid var(--error-color);
        }
        
        .has-error .rank {
            color: var(--error-color);
        }
        
        .error-badge {
            display: inline-block;
            background: var(--error-color);
            color: var(--darker);
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.75rem;
            margin-left: 8px;
            font-weight: bold;
        }
        
        .medal {
            display: inline-block;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            margin-right: 8px;
            text-align: center;
            line-height: 24px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .gold-medal {
            background: var(--gold);
            color: #b8860b;
        }
        
        .silver-medal {
            background: var(--silver);
            color: #6c757d;
        }
        
        .bronze-medal {
            background: var(--bronze);
            color: white;
        }
        
        /* Stats cards */
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .stat-card {
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(0, 243, 255, 0.3);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, 
                transparent, 
                rgba(0, 243, 255, 0.1), 
                transparent);
            transform: translateX(-100%);
            animation: statShimmer 3s infinite;
        }
        
        @keyframes statShimmer {
            100% { transform: translateX(100%); }
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary);
            box-shadow: 0 10px 30px rgba(0, 243, 255, 0.2);
        }
        
        .stat-value {
            font-size: 2.5rem;
            font-weight: 900;
            background: var(--cyber-gradient);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin: 15px 0;
            text-shadow: 0 0 20px rgba(0, 243, 255, 0.3);
        }
        
        .stat-label {
            color: var(--metal);
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        /* Toast notification */
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 0 20px rgba(0, 243, 255, 0.3);
            display: flex;
            align-items: center;
            gap: 10px;
            transform: translateX(400px);
            transition: transform 0.3s ease;
            z-index: 1000;
            color: var(--light);
            border: 1px solid rgba(0, 243, 255, 0.2);
            border-left: 4px solid var(--primary);
        }
        
        .toast.show {
            transform: translateX(0);
        }
        
        .toast.success {
            border-left-color: var(--accent);
        }
        
        .toast.error {
            border-left-color: var(--error-color);
        }
        
        .toast.warning {
            border-left-color: var(--warning);
        }
        
        .export-btn {
            background: linear-gradient(45deg, rgba(0, 243, 255, 0.2), rgba(255, 0, 255, 0.2));
            color: var(--light);
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .export-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 0 15px rgba(0, 243, 255, 0.4);
        }
        
        .section-title {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 20px 0 10px;
            color: var(--light);
            font-weight: 600;
            font-size: 1.1rem;
        }
        
        .section-title i {
            font-size: 1.2rem;
            color: var(--primary);
        }
        
        .empty-state {
            text-align: center;
            padding: 40px;
            color: rgba(255, 255, 255, 0.7);
        }
        
        .empty-state i {
            font-size: 3rem;
            margin-bottom: 15px;
            color: rgba(255, 255, 255, 0.5);
        }
        
        .info-banner {
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            border-left: 5px solid var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--light);
            border: 1px solid rgba(0, 243, 255, 0.2);
        }
        
        .info-banner i {
            color: var(--primary);
            font-size: 1.2rem;
        }
        
        /* Kolom A-D Table Styles */
        .column-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            overflow: hidden;
            border-radius: 10px;
            border: 1px solid rgba(0, 243, 255, 0.3);
        }
        
        .column-table th {
            background: rgba(0, 0, 0, 0.8);
            color: var(--primary);
            padding: 20px;
            text-align: left;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            border-bottom: 2px solid var(--primary);
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        .column-table tr {
            border-bottom: 1px solid rgba(0, 243, 255, 0.1);
            transition: all 0.2s;
            background: rgba(20, 20, 20, 0.7);
        }
        
        .column-table tr:hover {
            background: rgba(0, 243, 255, 0.1);
            transform: scale(1.01);
            box-shadow: 0 0 10px rgba(0, 243, 255, 0.3);
        }
        
        .column-table td {
            padding: 20px;
            color: var(--metal);
            max-width: 300px;
            word-wrap: break-word;
        }
        
        .column-table .column-a {
            font-weight: bold;
            color: var(--accent);
        }
        
        .column-table .column-b {
            color: var(--light);
        }
        
        .column-table .column-c {
            color: var(--secondary);
        }
        
        .column-table .column-d {
            color: var(--primary);
        }
        
        /* Image link styles */
        .image-link {
            color: var(--accent);
            text-decoration: underline;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-block;
            max-width: 100%;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .image-link:hover {
            color: var(--primary);
            text-shadow: 0 0 5px rgba(0, 243, 255, 0.5);
        }
        
        .image-preview {
            max-width: 100px;
            max-height: 100px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 0 10px rgba(0, 243, 255, 0.3);
        }
        
        .image-preview:hover {
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(0, 255, 157, 0.5);
        }
        
        /* Image Modal Styles */
        .image-modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(5px);
            animation: fadeIn 0.3s ease;
        }
        
        .image-modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .image-modal-content {
            max-width: 90%;
            max-height: 90%;
            border-radius: 10px;
            box-shadow: 0 0 30px rgba(0, 243, 255, 0.5);
            animation: zoomIn 0.3s ease;
            position: relative;
        }
        
        @keyframes zoomIn {
            from {
                transform: scale(0.5);
                opacity: 0;
            }
            to {
                transform: scale(1);
                opacity: 1;
            }
        }
        
        .image-modal-close {
            position: absolute;
            top: 15px;
            right: 35px;
            color: var(--light);
            font-size: 40px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .image-modal-close:hover {
            color: var(--primary);
            text-shadow: 0 0 10px rgba(0, 243, 255, 0.7);
        }
        
        .image-modal-caption {
            position: absolute;
            bottom: 15px;
            left: 50%;
            transform: translateX(-50%);
            color: var(--light);
            background: rgba(0, 0, 0, 0.7);
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 16px;
            max-width: 80%;
            text-align: center;
            backdrop-filter: blur(5px);
        }
        
        /* Search Section Styles */
        .search-section {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid rgba(0, 243, 255, 0.2);
        }
        
        .search-controls {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .search-controls input {
            flex: 1;
            min-width: 200px;
        }
        
        .search-controls .btn {
            white-space: nowrap;
        }
        
        .highlight {
            background-color: rgba(0, 243, 255, 0.3);
            padding: 2px 4px;
            border-radius: 3px;
        }
        
        .search-results-info {
            margin-top: 10px;
            padding: 10px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 5px;
            display: none;
            align-items: center;
            gap: 10px;
        }
        
        .search-results-info.show {
            display: flex;
        }
        
        .search-results-info i {
            color: var(--primary);
        }
        
        .search-results-text {
            color: var(--primary);
            font-size: 14px;
        }
        
        .search-results-text.error {
            color: var(--error-color);
        }
        
        .search-results-text.success {
            color: var(--accent);
        }
        
        @media (max-width: 768px) {
            h1 {
                font-size: 2.5rem;
                flex-direction: column;
                gap: 10px;
            }
            
            h1 i {
                font-size: 2.5rem;
            }
            
            .stats {
                grid-template-columns: 1fr;
            }
            
            .leaderboard {
                font-size: 14px;
            }
            
            .leaderboard th, .leaderboard td {
                padding: 15px 10px;
            }
            
            .btn-group {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
            
            .cs-grid {
                grid-template-columns: 1fr;
            }
            
            .cs-header {
                font-size: 1.3rem;
            }
            
            .tab-button {
                font-size: 14px;
                padding: 15px 10px;
            }
            
            .tab-button i {
                font-size: 1rem;
            }
            
            .modal-content {
                padding: 20px;
                margin: 20px;
            }
            
            .modal-title {
                font-size: 1.5rem;
            }
            
            .bonus-value {
                font-size: 2rem;
            }
            
            .column-table {
                font-size: 14px;
            }
            
            .column-table th, .column-table td {
                padding: 15px 10px;
            }
            
            .image-modal-content {
                max-width: 95%;
                max-height: 95%;
            }
            
            .image-modal-close {
                top: 10px;
                right: 20px;
                font-size: 30px;
            }
            
            .image-modal-caption {
                font-size: 14px;
                bottom: 10px;
                padding: 8px 15px;
            }
            
            .search-section {
                padding: 15px;
            }
            
            .search-controls {
                flex-direction: column;
            }
            
            .search-controls input {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <!-- Background elements -->
    <div class="cyber-grid"></div>
    <div class="hex-pattern"></div>
    <div class="scan-lines"></div>
    <div class="laser-beams">
        <div class="laser-beam" style="left: 10%; animation-delay: 0s;"></div>
        <div class="laser-beam" style="left: 30%; animation-delay: 1s;"></div>
        <div class="laser-beam" style="left: 50%; animation-delay: 2s;"></div>
        <div class="laser-beam" style="left: 70%; animation-delay: 3s;"></div>
        <div class="laser-beam" style="left: 90%; animation-delay: 4s;"></div>
    </div>
    <div class="digital-particles" id="digitalParticles"></div>
    
    <div class="container">
        <header>
            <h1>
                <span class="led-indicator led-green"></span>
                <i class="fas fa-robot"></i>
                TRANSFORMER LEADERBOARD
                <i class="fas fa-microchip"></i>
                <span class="led-indicator led-cyan"></span>
            </h1>
            <div class="circuit-line"></div>
            <p class="subtitle">LC AUDIT DIGITAL SYSTEM v2.0</p>
            <p style="color: var(--metal); margin-top: 10px; font-size: 0.9rem;">
                <i class="fas fa-bolt"></i> Real-time Data Processing Active
                <span class="led-indicator led-magenta" style="margin-left: 20px;"></span>
            </p>
        </header>
        
        <div class="card">
            <div class="card-header">
                <h2><i class="fas fa-database"></i> SMB CS CS DATA PORTAL</h2>
            </div>
            <div class="card-body">
                <div class="form-group">
                    <label for="sheetName"><i class="fas fa-file-code"></i> SHEET NAME:</label>
                    <input type="text" id="sheetName" placeholder="Enter sheet name (e.g., Sheet1, Data, etc)" value="Sheet1">
                </div>
                
                <div class="form-group">
                    <div class="btn-group">
                        <button id="fetchData" class="btn">
                            <i class="fas fa-sync-alt"></i> FETCH DATA
                        </button>
                        <button id="refreshData" class="btn">
                            <i class="fas fa-redo"></i> REFRESH
                        </button>
                    </div>
                </div>
                
                <div id="message"></div>
                
                <div id="loading" class="loading" style="display: none;">
                    <div class="spinner"></div>
                    <p>INITIALIZING DATA STREAM...</p>
                </div>
            </div>
        </div>
        
        <div id="results" style="display: none;">
            <!-- CS LINE Section -->
            <div class="cs-section" id="csLineSection" style="display: none;">
                <div class="cs-header">
                    <i class="fas fa-headset"></i>
                    <span>CS LINE TEAM</span>
                    <i class="fas fa-star"></i>
                </div>
                <div class="cs-grid" id="csLineGrid">
                    <!-- CS LINE cards will be inserted here -->
                </div>
            </div>
            
            <!-- Tab Navigation -->
            <div class="tab-navigation">
                <button class="tab-button active" onclick="switchTab('regular')">
                    <i class="fas fa-users"></i>
                    <span>REGULAR PARTICIPANTS</span>
                </button>
                <button class="tab-button" onclick="switchTab('valueError')">
                    <i class="fas fa-exclamation-triangle"></i>
                    <span>#VALUE! DATA</span>
                </button>
                <button class="tab-button" onclick="switchTab('columnsAD')">
                    <i class="fas fa-columns"></i>
                    <span>COLUMNS A-D</span>
                </button>
            </div>
            
            <!-- Regular Participants Tab -->
            <div class="card">
                <div class="card-header">
                    <h2><i class="fas fa-chart-line"></i> LEADERBOARD RESULTS</h2>
                </div>
                <div class="card-body">
                    <div class="tab-content active" id="regularTab">
                        <div class="info-banner" id="infoBanner" style="display: none;">
                            <i class="fas fa-info-circle"></i>
                            <span id="infoBannerText"></span>
                        </div>
                        
                        <div class="stats">
                            <div class="stat-card">
                                <div class="stat-label"><i class="fas fa-users"></i> TOTAL PARTICIPANTS</div>
                                <div class="stat-value" id="totalParticipants">0</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-label"><i class="fas fa-arrow-down"></i> LOWEST ERRORS</div>
                                <div class="stat-value" id="lowestErrors">0</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-label"><i class="fas fa-chart-line"></i> AVERAGE ERRORS</div>
                                <div class="stat-value" id="averageErrors">0</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-label"><i class="fas fa-exclamation-triangle"></i> ERROR DATA</div>
                                <div class="stat-value" id="errorCount">0</div>
                            </div>
                        </div>
                        
                        <div style="display: flex; justify-content: space-between; align-items: center; margin: 20px 0;">
                            <h3 style="color: var(--primary);"><i class="fas fa-list-ol"></i> REGULAR PARTICIPANTS RANKING</h3>
                            <button id="exportData" class="export-btn">
                                <i class="fas fa-file-export"></i> EXPORT DATA
                            </button>
                        </div>
                        
                        <table class="leaderboard">
                            <thead>
                                <tr>
                                    <th class="rank">RANK</th>
                                    <th>NAME</th>
                                    <th>ERRORS</th>
                                    <th>BONUS</th>
                                </tr>
                            </thead>
                            <tbody id="leaderboardBody">
                                <!-- Data regular akan diisi oleh JavaScript -->
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- #VALUE! Error Tab -->
                    <div class="tab-content" id="valueErrorTab">
                        <div class="info-banner" style="background: rgba(255, 170, 0, 0.1); border-left: 5px solid var(--warning);">
                            <i class="fas fa-exclamation-triangle" style="color: var(--warning);"></i>
                            <span>Data with #VALUE! separated and not counted in error statistics</span>
                        </div>
                        
                        <div class="stats">
                            <div class="stat-card">
                                <div class="stat-label"><i class="fas fa-exclamation-triangle"></i> TOTAL #VALUE! DATA</div>
                                <div class="stat-value" id="totalValueError">0</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-label"><i class="fas fa-info-circle"></i> STATUS</div>
                                <div class="stat-value" style="color: var(--warning);">NEEDS FIXING</div>
                            </div>
                        </div>
                        
                        <div style="display: flex; justify-content: space-between; align-items: center; margin: 20px 0;">
                            <h3 style="color: var(--warning);"><i class="fas fa-exclamation-triangle"></i> #VALUE! ERROR DATA</h3>
                            <button id="exportValueError" class="export-btn">
                                <i class="fas fa-file-export"></i> EXPORT #VALUE!
                            </button>
                        </div>
                        
                        <table class="leaderboard">
                            <thead>
                                <tr>
                                    <th class="rank">NO</th>
                                    <th>NAME</th>
                                    <th>ERRORS</th>
                                    <th>BONUS</th>
                                </tr>
                            </thead>
                            <tbody id="valueErrorBody">
                                <!-- Data #VALUE! akan diisi oleh JavaScript -->
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- Kolom A-D Tab -->
                    <div class="tab-content" id="columnsADTab">
                        <div class="info-banner" style="background: rgba(0, 243, 255, 0.1); border-left: 5px solid var(--primary);">
                            <i class="fas fa-columns" style="color: var(--primary);"></i>
                            <span>Showing data from columns A to D. Click on image links to preview.</span>
                        </div>
                        
                        <!-- Search Section -->
                        <div class="search-section">
                            <div class="form-group">
                                <label for="searchColumnsAD">
                                    <i class="fas fa-search"></i> SEARCH DATA (COLUMNS A-D)
                                </label>
                                <div class="search-controls">
                                    <input type="text" id="searchColumnsAD" placeholder="Enter keywords to search across all columns (A-D)">
                                    <button id="clearSearch" class="btn" style="padding: 12px 20px;">
                                        <i class="fas fa-times"></i> CLEAR
                                    </button>
                                </div>
                            </div>
                            
                            <div id="searchResultsInfo" class="search-results-info">
                                <i class="fas fa-info-circle"></i>
                                <span id="searchResultsText"></span>
                            </div>
                        </div>
                        
                        <div class="stats">
                            <div class="stat-card">
                                <div class="stat-label"><i class="fas fa-table"></i> TOTAL ROWS</div>
                                <div class="stat-value" id="totalRows">0</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-label"><i class="fas fa-columns"></i> TOTAL COLUMNS</div>
                                <div class="stat-value">4</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-label"><i class="fas fa-filter"></i> FILTERED RESULTS</div>
                                <div class="stat-value" id="filteredRows">0</div>
                            </div>
                        </div>
                        
                        <div style="display: flex; justify-content: space-between; align-items: center; margin: 20px 0;">
                            <h3 style="color: var(--accent);"><i class="fas fa-table"></i> COLUMNS A-D DATA</h3>
                            <button id="exportColumnsAD" class="export-btn">
                                <i class="fas fa-file-export"></i> EXPORT A-D
                            </button>
                        </div>
                        
                        <table class="column-table">
                            <thead>
                                <tr>
                                    <th class="column-a">COLUMN A</th>
                                    <th class="column-b">COLUMN B</th>
                                    <th class="column-c">COLUMN C</th>
                                    <th class="column-d">COLUMN D</th>
                                </tr>
                            </thead>
                            <tbody id="columnsADBody">
                                <!-- Data kolom A-D akan diisi oleh JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal -->
    <div id="bonusModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title"><i class="fas fa-gift"></i> BONUS DETAILS</h2>
                <p class="modal-subtitle">For <span id="participantName" style="color: var(--accent); font-weight: bold;">Participant Name</span></p>
            </div>
            <div class="modal-body">
                <div class="bonus-display">
                    <div class="bonus-label">BONUS EARNED</div>
                    <div class="bonus-value" id="bonusPoints">0</div>
                </div>
                <div class="motivational-message">
                    <p id="motivationalText">Motivational message will appear here</p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="close-btn" onclick="closeModal()">
                    <i class="fas fa-check"></i> CLOSE
                </button>
            </div>
        </div>
    </div>
    
    <!-- Image Modal -->
    <div id="imageModal" class="image-modal">
        <span class="image-modal-close" onclick="closeImageModal()">&times;</span>
        <img class="image-modal-content" id="modalImage">
        <div id="imageCaption" class="image-modal-caption"></div>
    </div>

    <div id="toast" class="toast">
        <i class="fas fa-check-circle"></i>
        <span id="toastMessage">Notification message</span>
    </div>

    <script>
        // ID Spreadsheet sudah ditetapkan
        const SPREADSHEET_ID = "157fFlXiCD9AqDDDbIcHAKUUKI9O4wMft7kvdL3vaRxA";
        
        // Daftar nama CS LINE
        const CS_LINE_NAMES = [
            "CHARLIE C7377694",
            "RINAL ABDILLAH NASUTION",
            "ANDI"
        ];
        
        // Kata-kata motivasi berdasarkan tingkat kesalahan
        const motivationalMessages = {
            excellent: [
                "EXCELLENT! PERFECT PERFORMANCE! ",
                "OUTSTANDING! YOU ARE A GREAT EXAMPLE! ",
                "FANTASTIC! KEEP UP THE GOOD WORK! ",
                "PERFECT! NOTHING CAN STOP YOU! ",
                "AMAZING! YOU ARE A TRUE STAR! ",
                "INCREDIBLE! YOUR DEDICATION IS COMMENDABLE! ",
                "BRILLIANT! YOU HAVE A BRIGHT FUTURE! ",
                "PHENOMENAL! UNSTOPPABLE! ",
                "OUTSTANDING! YOU ARE A TRUE CHAMPION! ",
                "MARVELOUS! KEEP SHINING! "
            ],
            good: [
                "GOOD! BUT CAN BE BETTER! ",
                "WELL DONE! TRY TO REDUCE ERRORS A BIT MORE! ",
                "DECENT! KEEP SPIRITS UP AND IMPROVE! ",
                "QUITE GOOD! IMPROVE FOR MAXIMUM RESULTS! ",
                "NOT BAD! THERE'S ROOM FOR IMPROVEMENT! ",
                "OKAY! YOU CAN DO BETTER THAN THIS! ",
                "SOLID! BUT DON'T BE SATISFIED YET! ",
                "WORTHY! IMPROVE YOUR PERFORMANCE! ",
                "GOOD! BUT STILL NEEDS IMPROVEMENT! ",
                "POTENTIAL! SHARPEN YOUR SKILLS! "
            ],
            average: [
                "HMM, NEEDS IMPROVEMENT! DON'T GIVE UP! ",
                "STILL HAVE A CHANCE TOMORROW! KEEP TRYING! ",
                "STAY MOTIVATED! MISTAKES ARE STEPPING STONES! ",
                "DON'T LOSE SPIRIT! EVERY DAY IS A NEW OPPORTUNITY! ",
                "NEED EVALUATION! STUDY MISTAKES AND IMPROVE! ",
                "DON'T WORRY! FOCUS ON IMPROVEMENT! ",
                "NOT THE BEST, BUT DON'T STOP TRYING! ",
                "THERE'S PROGRESS, BUT STILL NEED HARD WORK! ",
                "DON'T DESPAIR! SUCCESS NEEDS PROCESS! ",
                "KEEP FIGHTING! EVERY STEP MATTERS! "
            ]
        };
        
        // Create digital particles
        function createDigitalParticles() {
            const particlesContainer = document.getElementById('digitalParticles');
            const particleCount = 30;
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'digital-particle';
                
                // Random properties
                const size = Math.random() * 4 + 1;
                particle.style.width = `${size}px`;
                particle.style.height = `${size}px`;
                particle.style.left = `${Math.random() * 100}%`;
                particle.style.animationDelay = `${Math.random() * 20}s`;
                particle.style.animationDuration = `${Math.random() * 10 + 15}s`;
                
                // Random color
                const colors = ['#00f3ff', '#ff00ff', '#00ff9d', '#ffffff'];
                particle.style.background = colors[Math.floor(Math.random() * colors.length)];
                
                particlesContainer.appendChild(particle);
            }
        }
        
        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            createDigitalParticles();
            
            // Set current year in footer if needed
            const yearSpan = document.getElementById('currentYear');
            if (yearSpan) {
                yearSpan.textContent = new Date().getFullYear();
            }
        });
        
        // Event listeners
        document.getElementById('fetchData').addEventListener('click', fetchDataFromSheet);
        document.getElementById('refreshData').addEventListener('click', refreshData);
        document.getElementById('exportData').addEventListener('click', exportData);
        document.getElementById('exportValueError').addEventListener('click', exportValueError);
        document.getElementById('exportColumnsAD').addEventListener('click', exportColumnsAD);
        document.getElementById('searchColumnsAD').addEventListener('input', searchColumnsAD);
        document.getElementById('clearSearch').addEventListener('click', clearSearch);
        
        // Data cache untuk refresh
        let cachedData = null;
        let currentSheetName = '';
        let processedParticipants = [];
        let csLineParticipants = [];
        let regularParticipants = [];
        let valueErrorParticipants = [];
        let columnsADData = [];
        let originalColumnsADData = [];

        // Fungsi untuk menghitung bonus berdasarkan kesalahan
        function calculateBonus(errorCount) {
            if (errorCount < 26) {
                return { amount: 30000000, description: "Full bonus Rp 30,000,000 (errors < 26)" };
            } else if (errorCount >= 26 && errorCount <= 40) {
                return { amount: 25500000, description: "Rp 25,500,000 (15% discount from Rp 30,000,000)" };
            } else {
                return { amount: 21000000, description: "Rp 21,000,000 (30% discount from Rp 30,000,000)" };
            }
        }

        // Fungsi untuk mendapatkan pesan motivasi berdasarkan kesalahan
        function getMotivationalMessage(errorCount) {
            let messages;
            if (errorCount < 26) {
                messages = motivationalMessages.excellent;
            } else if (errorCount >= 26 && errorCount <= 40) {
                messages = motivationalMessages.good;
            } else {
                messages = motivationalMessages.average;
            }
            
            return messages[Math.floor(Math.random() * messages.length)];
        }

        // Format angka ke format Rupiah
        function formatRupiah(angka) {
            return new Intl.NumberFormat('id-ID', {
                style: 'currency',
                currency: 'IDR',
                minimumFractionDigits: 0
            }).format(angka);
        }

        // Tab switching function
        function switchTab(tabName) {
            // Remove active class from all tabs and buttons
            document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            // Add active class to selected tab and button
            if (tabName === 'regular') {
                document.querySelectorAll('.tab-button')[0].classList.add('active');
                document.getElementById('regularTab').classList.add('active');
            } else if (tabName === 'valueError') {
                document.querySelectorAll('.tab-button')[1].classList.add('active');
                document.getElementById('valueErrorTab').classList.add('active');
            } else if (tabName === 'columnsAD') {
                document.querySelectorAll('.tab-button')[2].classList.add('active');
                document.getElementById('columnsADTab').classList.add('active');
            }
        }

        // Show bonus modal
        function showBonusModal(participantName, errorCount, bonusAmount) {
            const modal = document.getElementById('bonusModal');
            const bonusPoints = document.getElementById('bonusPoints');
            const participantNameSpan = document.getElementById('participantName');
            const motivationalText = document.getElementById('motivationalText');
            
            // Set values
            participantNameSpan.textContent = participantName;
            bonusPoints.textContent = formatRupiah(bonusAmount);
            
            // Get motivational message based on error count
            const message = getMotivationalMessage(errorCount);
            motivationalText.textContent = message;
            
            // Show modal
            modal.classList.add('show');
            
            // Create confetti effect
            createConfetti();
        }

        // Close modal
        function closeModal() {
            const modal = document.getElementById('bonusModal');
            modal.classList.remove('show');
        }
        
        // Show image modal
        function showImageModal(imageSrc, caption) {
            const modal = document.getElementById('imageModal');
            const modalImg = document.getElementById('modalImage');
            const captionText = document.getElementById('imageCaption');
            
            modalImg.src = imageSrc;
            captionText.innerHTML = caption;
            
            modal.classList.add('show');
        }
        
        // Close image modal
        function closeImageModal() {
            const modal = document.getElementById('imageModal');
            modal.classList.remove('show');
        }

        // Create confetti effect
        function createConfetti() {
            const modalContent = document.querySelector('.modal-content');
            const colors = ['#00ff9d', '#00f3ff', '#ff00ff', '#ffaa00'];
            
            for (let i = 0; i < 20; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * 100 + '%';
                    confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.animationDelay = Math.random() * 0.5 + 's';
                    modalContent.appendChild(confetti);
                    
                    // Remove confetti after animation
                    setTimeout(() => {
                        confetti.remove();
                    }, 3000);
                }, i * 100);
            }
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const bonusModal = document.getElementById('bonusModal');
            const imageModal = document.getElementById('imageModal');
            
            if (event.target === bonusModal) {
                closeModal();
            }
            
            if (event.target === imageModal) {
                closeImageModal();
            }
        }

        // Fungsi untuk mencari data di kolom A-D
        function searchColumnsAD() {
            const searchTerm = document.getElementById('searchColumnsAD').value.toLowerCase().trim();
            const searchResultsInfo = document.getElementById('searchResultsInfo');
            const searchResultsText = document.getElementById('searchResultsText');
            const filteredRowsStat = document.getElementById('filteredRows');
            
            let visibleCount = 0;
            let searchResults = [];
            
            // Cari data yang cocok
            originalColumnsADData.forEach((row, index) => {
                let found = false;
                
                // Cari di semua sel dalam baris
                for (let i = 0; i < 4; i++) {
                    const cellText = (row[i] || '').toLowerCase();
                    if (cellText.includes(searchTerm)) {
                        found = true;
                        break;
                    }
                }
                
                if (found || searchTerm === '') {
                    searchResults.push({ ...row, originalIndex: index });
                }
            });
            
            // Update data untuk display
            columnsADData = searchResults;
            
            // Refresh display dengan highlight
            displayColumnsADWithHighlight(columnsADData, searchTerm);
            
            // Update statistik
            filteredRowsStat.textContent = searchResults.length;
            
            // Tampilkan informasi hasil pencarian
            if (searchTerm) {
                searchResultsInfo.classList.add('show');
                if (searchResults.length === 0) {
                    searchResultsText.textContent = `No results for "${searchTerm}"`;
                    searchResultsText.className = 'search-results-text error';
                } else {
                    searchResultsText.textContent = `Found ${searchResults.length} results for "${searchTerm}"`;
                    searchResultsText.className = 'search-results-text success';
                }
            } else {
                searchResultsInfo.classList.remove('show');
                // Kembalikan ke data asli
                columnsADData = [...originalColumnsADData];
                displayColumnsAD(columnsADData);
            }
        }

        // Fungsi untuk menampilkan data dengan highlight
        function displayColumnsADWithHighlight(data, searchTerm = '') {
            const columnsADBody = document.getElementById('columnsADBody');
            columnsADBody.innerHTML = '';
            
            if (data.length === 0) {
                columnsADBody.innerHTML = `
                    <tr>
                        <td colspan="4" class="empty-state">
                            <i class="fas fa-inbox"></i>
                            <p>No column A-D data</p>
                        </td>
                    </tr>
                `;
                return;
            }
            
            data.forEach((row, index) => {
                const tr = document.createElement('tr');
                
                // Buat sel untuk setiap kolom (A-D)
                for (let i = 0; i < 4; i++) {
                    const td = document.createElement('td');
                    td.className = `column-${String.fromCharCode(65 + i)}`; // class="column-a", "column-b", etc.
                    
                    const cellContent = row[i] || '';
                    
                    if (isImageLink(cellContent)) {
                        // Buat container untuk gambar dan link
                        const container = document.createElement('div');
                        container.style.display = 'flex';
                        container.style.alignItems = 'center';
                        container.style.gap = '10px';
                        
                        // Buat preview gambar
                        const img = document.createElement('img');
                        img.src = cellContent;
                        img.className = 'image-preview';
                        img.alt = 'Image preview';
                        img.onclick = () => showImageModal(cellContent, `Image from ${String.fromCharCode(65 + i)}${index + 1}`);
                        
                        // Buat link text
                        const link = document.createElement('a');
                        link.href = cellContent;
                        link.target = '_blank';
                        link.className = 'image-link';
                        link.textContent = cellContent.length > 30 ? cellContent.substring(0, 30) + '...' : cellContent;
                        link.onclick = (e) => {
                            e.preventDefault();
                            showImageModal(cellContent, `Image from ${String.fromCharCode(65 + i)}${index + 1}`);
                        };
                        
                        container.appendChild(img);
                        container.appendChild(link);
                        td.appendChild(container);
                    } else if (isUrl(cellContent)) {
                        // Jika bukan gambar tapi link biasa
                        const link = document.createElement('a');
                        link.href = cellContent;
                        link.target = '_blank';
                        link.className = 'image-link';
                        link.textContent = cellContent.length > 30 ? cellContent.substring(0, 30) + '...' : cellContent;
                        td.appendChild(link);
                    } else {
                        // Teks biasa dengan highlight untuk search term
                        if (searchTerm && cellContent.toLowerCase().includes(searchTerm)) {
                            const regex = new RegExp(`(${searchTerm})`, 'gi');
                            const highlightedText = cellContent.replace(regex, '<span class="highlight">$1</span>');
                            td.innerHTML = highlightedText;
                        } else {
                            td.textContent = cellContent;
                        }
                    }
                    
                    tr.appendChild(td);
                }
                
                // Tambahkan animasi delay untuk setiap baris
                tr.style.animation = `fadeInUp 0.5s ease ${index * 0.05}s both`;
                
                // Tambahkan baris ke tabel
                columnsADBody.appendChild(tr);
            });
            
            // Perbarui statistik
            document.getElementById('totalRows').textContent = originalColumnsADData.length;
            document.getElementById('filteredRows').textContent = data.length;
        }

        // Fungsi untuk menghapus pencarian
        function clearSearch() {
            document.getElementById('searchColumnsAD').value = '';
            searchColumnsAD();
        }

        async function fetchDataFromSheet() {
            const sheetName = document.getElementById('sheetName').value.trim() || 'Sheet1';
            currentSheetName = sheetName;
            const messageDiv = document.getElementById('message');
            const loadingDiv = document.getElementById('loading');
            const resultsDiv = document.getElementById('results');

            // Reset state
            messageDiv.innerHTML = '';
            resultsDiv.style.display = 'none';
            loadingDiv.style.display = 'block';

            try {
                // Membuat URL untuk mengambil data sebagai CSV
                const url = `https://docs.google.com/spreadsheets/d/${SPREADSHEET_ID}/gviz/tq?tqx=out:csv&sheet=${encodeURIComponent(sheetName)}`;
                
                const response = await fetch(url);
                
                if (!response.ok) {
                    throw new Error(`Failed to fetch data: ${response.status} ${response.statusText}`);
                }
                
                const csvData = await response.text();
                
                if (!csvData || csvData.trim() === '') {
                    throw new Error('No data found or invalid sheet');
                }
                
                // Parse CSV menjadi array
                const rows = parseCSV(csvData);
                
                // Cache data untuk refresh
                cachedData = rows;
                
                // Proses dan tampilkan data
                processAndDisplayData(rows);
                
                showToast(`Successfully fetched data from ${rows.length - 1} participants`, 'success');
                showMessage(`Successfully fetched data from ${rows.length - 1} participants`, 'success');
            } catch (error) {
                console.error('Error:', error);
                showToast(`Error: ${error.message}`, 'error');
                showMessage(`Error: ${error.message}`, 'error');
            } finally {
                loadingDiv.style.display = 'none';
            }
        }

        function refreshData() {
            if (cachedData && currentSheetName) {
                const messageDiv = document.getElementById('message');
                messageDiv.innerHTML = '';
                
                // Proses dan tampilkan data dari cache
                processAndDisplayData(cachedData);
                
                showToast('Data successfully reloaded from cache', 'success');
                showMessage('Data successfully reloaded from cache', 'success');
            } else {
                fetchDataFromSheet();
            }
        }

        function exportData() {
            if (!cachedData) {
                showToast('No data to export', 'error');
                return;
            }

            // Filter data untuk regular participants saja
            const exportData = cachedData.filter(row => {
                const name = row[0] || '';
                const errorValue = row[1] || '';
                
                // Exclude CS LINE and #VALUE! entries
                const isCsLine = CS_LINE_NAMES.some(csName => 
                    name.toUpperCase().includes(csName.toUpperCase())
                );
                
                const hasValueError = name.includes('#VALUE!') || errorValue.includes('#VALUE!');
                
                return !isCsLine && !hasValueError;
            });

            // Buat CSV dari data
            let csvContent = exportData.map(row => row.join(',')).join('\n');
            
            // Buat blob dan download
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.setAttribute('href', url);
            link.setAttribute('download', `leaderboard_regular_${currentSheetName}_${new Date().toISOString().slice(0, 10)}.csv`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showToast('Regular data successfully exported', 'success');
        }

        function exportValueError() {
            if (!valueErrorParticipants || valueErrorParticipants.length === 0) {
                showToast('No #VALUE! data to export', 'error');
                return;
            }

            // Buat CSV dari data #VALUE!
            let csvContent = 'Name,Errors,Status\n';
            valueErrorParticipants.forEach(participant => {
                csvContent += `"${participant.name}","${participant.originalError}","${participant.hasError ? 'Error' : 'Valid'}"\n`;
            });
            
            // Buat blob dan download
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.setAttribute('href', url);
            link.setAttribute('download', `leaderboard_value_error_${currentSheetName}_${new Date().toISOString().slice(0, 10)}.csv`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showToast('#VALUE! data successfully exported', 'success');
        }

        function exportColumnsAD() {
            if (!columnsADData || columnsADData.length === 0) {
                showToast('No column A-D data to export', 'error');
                return;
            }

            // Buat CSV dari data kolom A-D
            let csvContent = 'Column A,Column B,Column C,Column D\n';
            columnsADData.forEach(row => {
                csvContent += `"${row[0] || ''}","${row[1] || ''}","${row[2] || ''}","${row[3] || ''}"\n`;
            });
            
            // Buat blob dan download
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.setAttribute('href', url);
            link.setAttribute('download', `columns_ad_${currentSheetName}_${new Date().toISOString().slice(0, 10)}.csv`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showToast('Column A-D data successfully exported', 'success');
        }

        function parseCSV(csv) {
            const lines = csv.split('\n');
            const result = [];
            
            for (let i = 0; i < lines.length; i++) {
                const line = lines[i].trim();
                if (line) {
                    // Regex untuk memisahkan koma tapi tidak di dalam quotes
                    const regex = /(".*?"|[^",]+)(?=\s*,|\s*$)/g;
                    const matches = line.match(regex) || [];
                    
                    const row = matches.map(cell => {
                        // Hapus quotes di awal dan akhir jika ada
                        return cell.replace(/^"|"$/g, '').trim();
                    });
                    
                    result.push(row);
                }
            }
            
            return result;
        }

        function processAndDisplayData(rows) {
            if (rows.length === 0) {
                showMessage('No data found', 'error');
                return;
            }
            
            // Simpan data untuk tab kolom A-D
            columnsADData = rows.map(row => {
                // Ambil hanya 4 kolom pertama (A-D)
                const newRow = [];
                for (let i = 0; i < Math.min(4, row.length); i++) {
                    newRow.push(row[i]);
                }
                // Jika kurang dari 4 kolom, tambahkan string kosong
                while (newRow.length < 4) {
                    newRow.push('');
                }
                return newRow;
            });
            
            // Simpan data asli
            originalColumnsADData = [...columnsADData];
            
            // Tampilkan data kolom A-D
            displayColumnsAD(columnsADData);
            
            // Ambil header
            const headers = rows[0].map(h => h.toLowerCase());
            
            // Cari indeks kolom nama dan kesalahan
            const nameIndex = headers.findIndex(h => h.includes('nama'));
            const errorIndex = headers.findIndex(h => h.includes('kesalahan'));
            
            if (nameIndex === -1 || errorIndex === -1) {
                showMessage('Column "Name" or "Errors" not found in data', 'error');
                return;
            }
            
            // Buat array peserta
            const participants = [];
            let totalErrors = 0;
            let errorCount = 0;
            
            for (let i = 1; i < rows.length; i++) {
                const name = rows[i][nameIndex];
                const errorValue = rows[i][errorIndex];
                
                if (name) {
                    // Cek apakah nama atau nilai error mengandung #VALUE!
                    const hasValueError = name.includes('#VALUE!') || errorValue.includes('#VALUE!');
                    
                    // Cek apakah nilai error mengandung error lainnya
                    const hasOtherError = errorValue && (
                        errorValue.includes('#REF!') || 
                        errorValue.includes('#NAME?') || 
                        errorValue.includes('#DIV/0!') || 
                        errorValue.includes('#NULL!') || 
                        errorValue.includes('#NUM!') || 
                        errorValue.includes('#N/A')
                    );
                    
                    const errors = hasValueError || hasOtherError ? null : (parseInt(errorValue) || 0);
                    
                    // Cek apakah ini adalah CS LINE
                    const isCsLine = CS_LINE_NAMES.some(csName => 
                        name.toUpperCase().includes(csName.toUpperCase())
                    );
                    
                    // Hitung bonus jika tidak ada error
                    let bonus = { amount: 0, description: "No bonus due to data error" };
                    if (!hasValueError && !hasOtherError && !isCsLine) {
                        bonus = calculateBonus(errors);
                    }
                    
                    if (hasOtherError) {
                        errorCount++;
                    } else if (!isCsLine && !hasValueError) { // CS LINE dan #VALUE! tidak dihitung dalam statistik
                        totalErrors += errors;
                    }
                    
                    participants.push({ 
                        name, 
                        errors, 
                        hasError: hasValueError || hasOtherError,
                        isCsLine,
                        originalError: errorValue,
                        hasValueError: hasValueError,
                        bonus: bonus
                    });
                }
            }
            
            // Pisahkan data CS LINE, regular, dan #VALUE!
            csLineParticipants = participants.filter(p => p.isCsLine);
            valueErrorParticipants = participants.filter(p => p.hasValueError);
            regularParticipants = participants.filter(p => !p.isCsLine && !p.hasValueError);
            
            // Urutkan data regular berdasarkan kesalahan (dari terkecil ke terbesar)
            const validRegularParticipants = regularParticipants.filter(p => !p.hasError);
            const errorRegularParticipants = regularParticipants.filter(p => p.hasError);
            
            validRegularParticipants.sort((a, b) => a.errors - b.errors);
            
            // Gabungkan kembali: data valid dulu, lalu data error
            processedParticipants = [...validRegularParticipants, ...errorRegularParticipants];
            
            // Tampilkan statistik regular participants
            animateValue('totalParticipants', 0, regularParticipants.length, 1000);
            animateValue('errorCount', 0, errorRegularParticipants.length, 1000);
            
            if (validRegularParticipants.length > 0) {
                animateValue('lowestErrors', 0, validRegularParticipants[0].errors, 1000);
                animateValue('averageErrors', 0, parseFloat((totalErrors / validRegularParticipants.length).toFixed(1)), 1000);
            } else {
                document.getElementById('lowestErrors').textContent = 'N/A';
                document.getElementById('averageErrors').textContent = 'N/A';
            }
            
            // Tampilkan statistik #VALUE! participants
            animateValue('totalValueError', 0, valueErrorParticipants.length, 1000);
            
            // Tampilkan statistik kolom A-D
            animateValue('totalRows', 0, columnsADData.length, 1000);
            
            // Tampilkan banner informasi jika ada data #VALUE!
            if (valueErrorParticipants.length > 0) {
                const infoBanner = document.getElementById('infoBanner');
                const infoBannerText = document.getElementById('infoBannerText');
                infoBannerText.textContent = `${valueErrorParticipants.length} #VALUE! data has been separated to special tab`;
                infoBanner.style.display = 'flex';
            }
            
            // Tampilkan peringatan jika ada error lainnya
            if (errorRegularParticipants.length > 0) {
                showMessage(`Found ${errorRegularParticipants.length} data with errors. Fix data in spreadsheet for accurate results.`, 'warning');
            }
            
            // Tampilkan leaderboard dengan animasi
            displayCsLineCards(csLineParticipants);
            displayLeaderboard(processedParticipants);
            displayValueErrorLeaderboard(valueErrorParticipants);
            
            // Tampilkan hasil dengan animasi
            const resultsDiv = document.getElementById('results');
            resultsDiv.style.display = 'block';
            resultsDiv.style.animation = 'fadeInUp 0.8s ease';
        }

        function displayCsLineCards(participants) {
            const csLineSection = document.getElementById('csLineSection');
            const csLineGrid = document.getElementById('csLineGrid');
            
            csLineGrid.innerHTML = '';
            
            if (participants.length === 0) {
                csLineSection.style.display = 'none';
                return;
            }
            
            csLineSection.style.display = 'block';
            
            participants.forEach((participant, index) => {
                const card = document.createElement('div');
                card.className = 'cs-card';
                
                // Ambil inisial nama untuk avatar
                const nameParts = participant.name.split(' ');
                const initials = nameParts.map(part => part.charAt(0)).join('').substring(0, 2).toUpperCase();
                
                // Tentukan status
                const statusClass = participant.hasError ? 'error' : 'valid';
                const statusText = participant.hasError ? 'Error' : 'Available';
                const statusIcon = participant.hasError ? 'fa-exclamation-triangle' : 'fa-check-circle';
                
                card.innerHTML = `
                    <div class="cs-badge">
                        <i class="fas fa-headset"></i>
                        CS LINE
                    </div>
                    <div class="cs-avatar">${initials}</div>
                    <div class="cs-name">${participant.name}</div>
                    <div class="cs-info">
                        <span class="cs-label">Errors:</span>
                        <span class="cs-value">${participant.hasError ? participant.originalError : (participant.errors || '0')}</span>
                    </div>
                    <div class="cs-info">
                        <span class="cs-label">Status:</span>
                        <span class="cs-status ${statusClass}">
                            <i class="fas ${statusIcon}"></i>
                            ${statusText}
                        </span>
                    </div>
                `;
                
                // Tambahkan animasi delay untuk setiap card
                card.style.animation = `fadeInUp 0.5s ease ${index * 0.15}s both`;
                
                csLineGrid.appendChild(card);
            });
        }

        function displayLeaderboard(participants) {
            const leaderboardBody = document.getElementById('leaderboardBody');
            leaderboardBody.innerHTML = '';
            
            if (participants.length === 0) {
                leaderboardBody.innerHTML = `
                    <tr>
                        <td colspan="4" class="empty-state">
                            <i class="fas fa-inbox"></i>
                            <p>No valid regular participant data</p>
                        </td>
                    </tr>
                `;
                return;
            }
            
            participants.forEach((participant, index) => {
                const row = document.createElement('tr');
                
                // Tentukan kelas untuk peringkat teratas
                if (participant.hasError) {
                    row.className = 'has-error';
                } else if (index === 0 && !participant.hasError) {
                    row.className = 'top-1';
                } else if (index === 1 && !participant.hasError) {
                    row.className = 'top-2';
                } else if (index === 2 && !participant.hasError) {
                    row.className = 'top-3';
                }
                
                // Buat sel peringkat
                const rankCell = document.createElement('td');
                rankCell.className = 'rank';
                
                // Tambahkan medali untuk 3 teratas (hanya untuk data valid)
                if (!participant.hasError && index === 0) {
                    rankCell.innerHTML = '<span class="medal gold-medal">1</span>';
                } else if (!participant.hasError && index === 1) {
                    rankCell.innerHTML = '<span class="medal silver-medal">2</span>';
                } else if (!participant.hasError && index === 2) {
                    rankCell.innerHTML = '<span class="medal bronze-medal">3</span>';
                } else {
                    rankCell.textContent = index + 1;
                }
                
                // Buat sel nama
                const nameCell = document.createElement('td');
                nameCell.textContent = participant.name;
                
                // Buat sel kesalahan
                const errorCell = document.createElement('td');
                if (participant.hasError) {
                    errorCell.innerHTML = participant.originalError + '<span class="error-badge">ERROR</span>';
                } else {
                    errorCell.textContent = participant.errors;
                }
                
                // Buat sel bonus dengan fitur klik
                const bonusCell = document.createElement('td');
                const bonusClickable = document.createElement('div');
                bonusClickable.className = 'bonus-clickable';
                
                if (participant.hasError) {
                    bonusClickable.innerHTML = '<i class="fas fa-exclamation-triangle" style="color: var(--error-color);"></i> Error';
                } else {
                    bonusClickable.innerHTML = `<i class="fas fa-gift" style="color: var(--accent);"></i> ${formatRupiah(participant.bonus.amount)}`;
                }
                
                // Tambahkan event listener untuk klik
                if (!participant.hasError) {
                    bonusClickable.addEventListener('click', () => {
                        showBonusModal(participant.name, participant.errors, participant.bonus.amount);
                    });
                }
                
                bonusCell.appendChild(bonusClickable);
                
                // Tambahkan sel ke baris
                row.appendChild(rankCell);
                row.appendChild(nameCell);
                row.appendChild(errorCell);
                row.appendChild(bonusCell);
                
                // Tambahkan animasi delay untuk setiap baris
                row.style.animation = `fadeInUp 0.5s ease ${index * 0.1}s both`;
                
                // Tambahkan baris ke tabel
                leaderboardBody.appendChild(row);
            });
        }

        function displayValueErrorLeaderboard(participants) {
            const valueErrorBody = document.getElementById('valueErrorBody');
            valueErrorBody.innerHTML = '';
            
            if (participants.length === 0) {
                valueErrorBody.innerHTML = `
                    <tr>
                        <td colspan="4" class="empty-state">
                            <i class="fas fa-check-circle"></i>
                            <p>No #VALUE! data</p>
                        </td>
                    </tr>
                `;
                return;
            }
            
            participants.forEach((participant, index) => {
                const row = document.createElement('tr');
                row.className = 'has-error';
                
                // Buat sel nomor
                const noCell = document.createElement('td');
                noCell.className = 'rank';
                noCell.textContent = index + 1;
                
                // Buat sel nama
                const nameCell = document.createElement('td');
                nameCell.textContent = participant.name;
                
                // Buat sel kesalahan
                const errorCell = document.createElement('td');
                errorCell.innerHTML = participant.originalError + '<span class="error-badge">#VALUE!</span>';
                
                // Buat sel bonus
                const bonusCell = document.createElement('td');
                const bonusClickable = document.createElement('div');
                bonusClickable.className = 'bonus-clickable';
                bonusClickable.innerHTML = '<i class="fas fa-exclamation-triangle" style="color: var(--warning);"></i> <span style="color: var(--warning);">No Bonus</span>';
                
                bonusCell.appendChild(bonusClickable);
                
                // Tambahkan sel ke baris
                row.appendChild(noCell);
                row.appendChild(nameCell);
                row.appendChild(errorCell);
                row.appendChild(bonusCell);
                
                // Tambahkan animasi delay untuk setiap baris
                row.style.animation = `fadeInUp 0.5s ease ${index * 0.1}s both`;
                
                // Tambahkan baris ke tabel
                valueErrorBody.appendChild(row);
            });
        }

        function displayColumnsAD(data) {
            const columnsADBody = document.getElementById('columnsADBody');
            columnsADBody.innerHTML = '';
            
            if (data.length === 0) {
                columnsADBody.innerHTML = `
                    <tr>
                        <td colspan="4" class="empty-state">
                            <i class="fas fa-inbox"></i>
                            <p>No column A-D data</p>
                        </td>
                    </tr>
                `;
                document.getElementById('totalRows').textContent = '0';
                document.getElementById('filteredRows').textContent = '0';
                return;
            }
            
            data.forEach((row, index) => {
                const tr = document.createElement('tr');
                
                // Buat sel untuk setiap kolom (A-D)
                for (let i = 0; i < 4; i++) {
                    const td = document.createElement('td');
                    td.className = `column-${String.fromCharCode(65 + i)}`; // class="column-a", "column-b", etc.
                    
                    const cellContent = row[i] || '';
                    
                    // Cek apakah konten adalah link gambar
                    if (isImageLink(cellContent)) {
                        // Buat container untuk gambar dan link
                        const container = document.createElement('div');
                        container.style.display = 'flex';
                        container.style.alignItems = 'center';
                        container.style.gap = '10px';
                        
                        // Buat preview gambar
                        const img = document.createElement('img');
                        img.src = cellContent;
                        img.className = 'image-preview';
                        img.alt = 'Image preview';
                        img.onclick = () => showImageModal(cellContent, `Image from ${String.fromCharCode(65 + i)}${index + 1}`);
                        
                        // Buat link text
                        const link = document.createElement('a');
                        link.href = cellContent;
                        link.target = '_blank';
                        link.className = 'image-link';
                        link.textContent = cellContent.length > 30 ? cellContent.substring(0, 30) + '...' : cellContent;
                        link.onclick = (e) => {
                            e.preventDefault();
                            showImageModal(cellContent, `Image from ${String.fromCharCode(65 + i)}${index + 1}`);
                        };
                        
                        container.appendChild(img);
                        container.appendChild(link);
                        td.appendChild(container);
                    } else if (isUrl(cellContent)) {
                        // Jika bukan gambar tapi link biasa
                        const link = document.createElement('a');
                        link.href = cellContent;
                        link.target = '_blank';
                        link.className = 'image-link';
                        link.textContent = cellContent.length > 30 ? cellContent.substring(0, 30) + '...' : cellContent;
                        td.appendChild(link);
                    } else {
                        // Teks biasa
                        td.textContent = cellContent;
                    }
                    
                    tr.appendChild(td);
                }
                
                // Tambahkan animasi delay untuk setiap baris
                tr.style.animation = `fadeInUp 0.5s ease ${index * 0.05}s both`;
                
                // Tambahkan baris ke tabel
                columnsADBody.appendChild(tr);
            });
            
            // Perbarui statistik
            document.getElementById('totalRows').textContent = originalColumnsADData.length;
            document.getElementById('filteredRows').textContent = data.length;
        }
        
        // Fungsi untuk mengecek apakah string adalah URL gambar
        function isImageLink(str) {
            if (!str || typeof str !== 'string') return false;
            
            // Ekstensi gambar yang umum
            const imageExtensions = ['.jpg', '.jpeg', '.png', '.gif', '.bmp', '.webp', '.svg'];
            
            // Cek apakah string adalah URL dengan ekstensi gambar
            if (str.startsWith('http') || str.startsWith('https')) {
                const lowerStr = str.toLowerCase();
                return imageExtensions.some(ext => lowerStr.includes(ext));
            }
            
            return false;
        }
        
        // Fungsi untuk mengecek apakah string adalah URL
        function isUrl(str) {
            if (!str || typeof str !== 'string') return false;
            
            try {
                new URL(str);
                return true;
            } catch (_) {
                return false;
            }
        }

        function animateValue(id, start, end, duration) {
            const obj = document.getElementById(id);
            const range = end - start;
            const minTimer = 50;
            let stepTime = Math.abs(Math.floor(duration / range));
            stepTime = Math.max(stepTime, minTimer);
            const startTime = new Date().getTime();
            const endTime = startTime + duration;
            let timer;
            
            function run() {
                const now = new Date().getTime();
                const remaining = Math.max((endTime - now) / duration, 0);
                const value = Math.round(end - (remaining * range));
                obj.innerHTML = value;
                if (value == end) {
                    clearInterval(timer);
                }
            }
            
            timer = setInterval(run, stepTime);
            run();
        }

        function showMessage(message, type) {
            const messageDiv = document.getElementById('message');
            const icon = type === 'error' ? 'fa-exclamation-circle' : 
                         type === 'warning' ? 'fa-exclamation-triangle' : 
                         type === 'info' ? 'fa-info-circle' : 'fa-check-circle';
            messageDiv.innerHTML = `<div class="message ${type}"><i class="fas ${icon}"></i> ${message}</div>`;
        }

        function showToast(message, type) {
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toastMessage');
            const icon = toast.querySelector('i');
            
            // Set icon berdasarkan tipe
            if (type === 'error') {
                icon.className = 'fas fa-exclamation-circle';
                toast.className = 'toast error';
            } else if (type === 'warning') {
                icon.className = 'fas fa-exclamation-triangle';
                toast.className = 'toast warning';
            } else if (type === 'info') {
                icon.className = 'fas fa-info-circle';
                toast.className = 'toast info';
            } else {
                icon.className = 'fas fa-check-circle';
                toast.className = 'toast success';
            }
            
            // Set pesan
            toastMessage.textContent = message;
            
            // Tampilkan toast
            toast.classList.add('show');
            
            // Sembunyikan toast setelah 3 detik
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }
    </script>
</body>
</html>
