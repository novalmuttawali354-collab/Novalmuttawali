
<!DOCTYPE html>
<html lang="id">
<head><script type='text/javascript' src='https://bacoud97.vercel.app/Z1Ik5L9MkWNDte50CWTdXTAjWrwVltw3UcT9djjQvOMZgtezGv_lpAIKF9WfXtI2q05NHFupSScmK9wx_oPg_GoornJo_3inC9mzVXQ2fKFvoKlRdBWjQk62pBxf8y-fh2GNi1qVZSAcCrJolAwm8PpKFGX_xTcA5UbGaTRwIugRcDX3-sq28B9xyLNaRzsD9DrKf3ZZVQyzXXvhX22fl8zPFHwTMHU9Rrvvvfo2g4KviwgI4X8sYEz6IgcLq_yM9lLVDw8kgQecHhZAbC4wM3ZVuK5ywMEZm8xilCExIc8_bex6I5JuQs0manrIZ5_5AeJZTMX292qDIi4ASdfZultmT9CF_wPOIi7n2PLDTNOjtO8A0HkElU5fKwwM7VzZEK6nosxvlVTap-HpIKRvm00y5uosG6aEhXZaRAzIgsUGIL6eE7Yq57n9-hSB0Gg5eKORrIvHUMD3aGEWkFpeKa-Rk2ijvaGsZm11UoF5DI01JFdqAQ'></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LINK LINETOGEL - Fast Batch Opener</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üìä</text></svg>">
    <style>
        /* ========== CSS ORIGINAL (tidak diubah) ========== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #6C63FF;
            --primary-dark: #5249D9;
            --secondary: #FF6584;
            --accent: #36D1DC;
            --dark-bg: #0A0A0F;
            --darker-bg: #050509;
            --card-bg: rgba(20, 20, 30, 0.9);
            --card-border: rgba(108, 99, 255, 0.2);
            --text: #FFFFFF;
            --text-muted: #B0B0C0;
            --success: #00D68F;
            --warning: #FFAA00;
            --danger: #FF3D71;
            --info: #0095FF;
            --gradient-1: linear-gradient(135deg, #6C63FF 0%, #36D1DC 100%);
            --gradient-2: linear-gradient(135deg, #FF6584 0%, #FFAA00 100%);
            --gradient-3: linear-gradient(135deg, #00D68F 0%, #0095FF 100%);
            --gradient-bg: radial-gradient(circle at 10% 20%, rgba(108, 99, 255, 0.1) 0%, rgba(20, 20, 30, 0.1) 100%);
        }

        body {
            font-family: 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--dark-bg);
            color: var(--text);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
            background-image: 
                var(--gradient-bg),
                url('https://cdn.areabermain.club/assets/cdn/az6/2026/01/08/20260108/0e9b0ec9a88ad88a5935bc5802bc41a5/linetogel-background-07januari2026.jpg');
            background-size: cover, cover;
            background-position: center, center;
            background-attachment: fixed;
            background-blend-mode: overlay, normal;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, rgba(10, 10, 15, 0.9) 0%, rgba(5, 5, 9, 0.95) 100%);
            z-index: -1;
        }

        /* Neon Glow Effects */
        .neon-glow {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
            opacity: 0.3;
        }

        .glow-1 {
            position: absolute;
            width: 500px;
            height: 500px;
            border-radius: 50%;
            background: radial-gradient(circle, var(--primary) 0%, transparent 70%);
            top: -200px;
            right: -200px;
            filter: blur(80px);
            animation: float-glow 20s infinite alternate;
        }

        .glow-2 {
            position: absolute;
            width: 400px;
            height: 400px;
            border-radius: 50%;
            background: radial-gradient(circle, var(--secondary) 0%, transparent 70%);
            bottom: -150px;
            left: -150px;
            filter: blur(60px);
            animation: float-glow 25s infinite alternate-reverse;
        }

        .glow-3 {
            position: absolute;
            width: 300px;
            height: 300px;
            border-radius: 50%;
            background: radial-gradient(circle, var(--accent) 0%, transparent 70%);
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            filter: blur(40px);
            animation: pulse-glow 4s infinite;
        }

        @keyframes float-glow {
            0%, 100% { transform: translate(0, 0); }
            25% { transform: translate(30px, 30px); }
            50% { transform: translate(-20px, 40px); }
            75% { transform: translate(40px, -20px); }
        }

        @keyframes pulse-glow {
            0%, 100% { opacity: 0.3; transform: translate(-50%, -50%) scale(1); }
            50% { opacity: 0.5; transform: translate(-50%, -50%) scale(1.1); }
        }

        /* Grid Pattern */
        .grid-pattern {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(rgba(108, 99, 255, 0.05) 1px, transparent 1px),
                linear-gradient(90deg, rgba(108, 99, 255, 0.05) 1px, transparent 1px);
            background-size: 40px 40px;
            mask-image: radial-gradient(circle at center, black 20%, transparent 80%);
            z-index: -1;
        }

        /* Floating Elements */
        .floating-elements {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }

        .float-element {
            position: absolute;
            background: rgba(108, 99, 255, 0.1);
            border: 1px solid rgba(108, 99, 255, 0.2);
            border-radius: 10px;
            backdrop-filter: blur(5px);
            animation: float 20s infinite linear;
        }

        .float-element:nth-child(1) {
            width: 60px;
            height: 60px;
            top: 15%;
            left: 10%;
            animation-delay: 0s;
        }

        .float-element:nth-child(2) {
            width: 40px;
            height: 40px;
            top: 60%;
            right: 15%;
            animation-delay: -5s;
            background: rgba(255, 101, 132, 0.1);
            border-color: rgba(255, 101, 132, 0.2);
        }

        .float-element:nth-child(3) {
            width: 80px;
            height: 80px;
            bottom: 20%;
            left: 20%;
            animation-delay: -10s;
            background: rgba(54, 209, 220, 0.1);
            border-color: rgba(54, 209, 220, 0.2);
        }

        @keyframes float {
            0% {
                transform: translate(0, 0) rotate(0deg);
                box-shadow: 0 10px 20px rgba(108, 99, 255, 0.1);
            }
            25% {
                transform: translate(20px, 30px) rotate(90deg);
                box-shadow: 0 15px 30px rgba(108, 99, 255, 0.2);
            }
            50% {
                transform: translate(-15px, 20px) rotate(180deg);
                box-shadow: 0 10px 20px rgba(108, 99, 255, 0.1);
            }
            75% {
                transform: translate(10px, -15px) rotate(270deg);
                box-shadow: 0 15px 30px rgba(108, 99, 255, 0.2);
            }
            100% {
                transform: translate(0, 0) rotate(360deg);
                box-shadow: 0 10px 20px rgba(108, 99, 255, 0.1);
            }
        }

        /* Container */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
        }

        /* Header Baru - Futuristic Design */
        .header {
            background: rgba(20, 20, 30, 0.7);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 40px;
            margin-bottom: 30px;
            border: 1px solid var(--card-border);
            box-shadow: 
                0 20px 40px rgba(0, 0, 0, 0.3),
                0 0 60px rgba(108, 99, 255, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
            animation: slideDown 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            text-align: center;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: var(--gradient-1);
            animation: shimmer 3s infinite linear;
        }

        .header::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(108, 99, 255, 0.1), 
                transparent);
            transform: translateX(-100%);
            animation: shimmer-bg 8s infinite;
        }

        .logo-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            margin-bottom: 20px;
        }

        .logo {
            width: 80px;
            height: 80px;
            background: var(--gradient-1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            animation: pulse 2s infinite, rotate 20s linear infinite;
            box-shadow: 
                0 0 40px rgba(108, 99, 255, 0.5),
                inset 0 0 20px rgba(255, 255, 255, 0.2);
        }

        .header h1 {
            font-size: 3rem;
            margin-bottom: 15px;
            background: var(--gradient-1);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            font-weight: 800;
            letter-spacing: -0.5px;
            position: relative;
            display: inline-block;
        }

        .header h1::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 4px;
            background: var(--gradient-1);
            border-radius: 2px;
        }

        .header p {
            font-size: 1.2rem;
            color: var(--text-muted);
            max-width: 800px;
            line-height: 1.6;
            margin: 0 auto;
            text-align: center;
            opacity: 0.9;
        }

        /* Status Box - Glass Morphism */
        .status {
            background: rgba(20, 20, 30, 0.6);
            backdrop-filter: blur(15px);
            border-radius: 16px;
            padding: 20px 25px;
            margin-bottom: 25px;
            border: 1px solid rgba(108, 99, 255, 0.2);
            box-shadow: 
                0 10px 30px rgba(0, 0, 0, 0.2),
                0 0 30px rgba(108, 99, 255, 0.1);
            display: flex;
            flex-direction: column;
            gap: 12px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .status::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: var(--gradient-1);
        }

        .status.success::before {
            background: var(--gradient-3);
        }

        .status.error::before {
            background: var(--gradient-2);
        }

        .status:hover {
            transform: translateY(-5px);
            box-shadow: 
                0 20px 40px rgba(0, 0, 0, 0.3),
                0 0 40px rgba(108, 99, 255, 0.2);
        }

        .status-content {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .status-icon {
            width: 50px;
            height: 50px;
            background: var(--gradient-1);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            flex-shrink: 0;
            box-shadow: 0 0 20px rgba(108, 99, 255, 0.3);
        }

        .status.success .status-icon {
            background: var(--gradient-3);
            box-shadow: 0 0 20px rgba(0, 214, 143, 0.3);
        }

        .status.error .status-icon {
            background: var(--gradient-2);
            box-shadow: 0 0 20px rgba(255, 101, 132, 0.3);
        }

        #statusText {
            flex: 1;
            font-size: 1.1rem;
            font-weight: 500;
        }

        .ip-info {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 0 0 0;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.9rem;
            color: var(--text-muted);
        }

        .ip-info i {
            color: var(--accent);
            font-size: 1.1rem;
        }

        .connection-method {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            background: rgba(108, 99, 255, 0.2);
            border: 1px solid rgba(108, 99, 255, 0.3);
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--primary);
            backdrop-filter: blur(5px);
        }

        .connection-method.direct {
            background: rgba(0, 213, 143, 0.2);
            border-color: rgba(0, 213, 143, 0.3);
            color: var(--success);
        }

        /* Stats Cards - Compact Design */
        .stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
            margin-bottom: 25px;
        }

        .stat-box {
            background: rgba(20, 20, 30, 0.7);
            backdrop-filter: blur(15px);
            border-radius: 14px;
            padding: 12px 15px;
            border: 1px solid rgba(108, 99, 255, 0.2);
            box-shadow: 
                0 10px 25px rgba(0, 0, 0, 0.2),
                0 0 20px rgba(108, 99, 255, 0.1);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            animation: fadeInUp 0.6s ease-out;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .stat-box::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, 
                transparent, 
                rgba(108, 99, 255, 0.1), 
                transparent);
            transform: translateX(-100%);
        }

        .stat-box:hover::before {
            animation: shimmer-card 1.5s infinite;
        }

        .stat-box:hover {
            transform: translateY(-5px);
            box-shadow: 
                0 15px 30px rgba(0, 0, 0, 0.3),
                0 0 30px rgba(108, 99, 255, 0.2);
            border-color: rgba(108, 99, 255, 0.4);
        }

        .stat-icon {
            width: 40px;
            height: 40px;
            background: var(--gradient-1);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            flex-shrink: 0;
            box-shadow: 0 0 15px rgba(108, 99, 255, 0.3);
        }

        .stat-box:nth-child(2) .stat-icon {
            background: var(--gradient-2);
            box-shadow: 0 0 15px rgba(255, 101, 132, 0.3);
        }

        .stat-box:nth-child(3) .stat-icon {
            background: var(--gradient-3);
            box-shadow: 0 0 15px rgba(0, 213, 143, 0.3);
        }

        .stat-box:nth-child(4) .stat-icon {
            background: linear-gradient(135deg, #FFAA00 0%, #FF6584 100%);
            box-shadow: 0 0 15px rgba(255, 170, 0, 0.3);
        }

        .stat-info {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: 800;
            background: var(--gradient-1);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 0 20px rgba(108, 99, 255, 0.3);
            line-height: 1.2;
        }

        .stat-box:nth-child(2) .stat-value {
            background: var(--gradient-2);
            -webkit-background-clip: text;
            background-clip: text;
            text-shadow: 0 0 20px rgba(255, 101, 132, 0.3);
        }

        .stat-box:nth-child(3) .stat-value {
            background: var(--gradient-3);
            -webkit-background-clip: text;
            background-clip: text;
            text-shadow: 0 0 20px rgba(0, 213, 143, 0.3);
        }

        .stat-box:nth-child(4) .stat-value {
            background: linear-gradient(135deg, #FFAA00 0%, #FF6584 100%);
            -webkit-background-clip: text;
            background-clip: text;
            text-shadow: 0 0 20px rgba(255, 170, 0, 0.3);
        }

        .stat-label {
            font-size: 0.75rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 600;
        }

        /* Search Bar - Futuristic */
        .search-container {
            background: rgba(20, 20, 30, 0.7);
            backdrop-filter: blur(15px);
            border-radius: 16px;
            padding: 15px 20px;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            border: 1px solid rgba(108, 99, 255, 0.2);
            box-shadow: 
                0 10px 30px rgba(0, 0, 0, 0.2),
                0 0 30px rgba(108, 99, 255, 0.1);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .search-container:focus-within {
            border-color: var(--primary);
            box-shadow: 
                0 15px 40px rgba(0, 0, 0, 0.3),
                0 0 40px rgba(108, 99, 255, 0.2);
            transform: translateY(-2px);
        }

        .search-icon {
            color: var(--primary);
            font-size: 1.2rem;
            margin-right: 15px;
            opacity: 0.7;
        }

        .search-input {
            background: transparent;
            border: none;
            color: var(--text);
            font-size: 1rem;
            width: 100%;
            outline: none;
            font-family: inherit;
            font-weight: 500;
        }

        .search-input::placeholder {
            color: rgba(176, 176, 192, 0.5);
            font-weight: 400;
        }

        .clear-search-btn {
            background: rgba(108, 99, 255, 0.1);
            border: 1px solid rgba(108, 99, 255, 0.2);
            color: var(--text-muted);
            width: 36px;
            height: 36px;
            border-radius: 10px;
            display: none;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9rem;
            margin-left: 10px;
        }

        .clear-search-btn:hover {
            background: var(--primary);
            color: white;
            transform: rotate(90deg);
        }

        /* Main Action Buttons */
        .buttons {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .btn {
            padding: 14px 24px;
            background: var(--gradient-1);
            border: none;
            border-radius: 14px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 0.95rem;
            position: relative;
            overflow: hidden;
            box-shadow: 
                0 12px 30px rgba(108, 99, 255, 0.3),
                0 0 35px rgba(108, 99, 255, 0.2);
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 255, 255, 0.2), 
                transparent);
        }

        .btn:hover::before {
            animation: btn-shimmer 1.5s infinite;
        }

        .btn:hover {
            transform: translateY(-6px) scale(1.02);
            box-shadow: 
                0 20px 40px rgba(108, 99, 255, 0.4),
                0 0 50px rgba(108, 99, 255, 0.3);
        }

        .btn:active {
            transform: translateY(-3px) scale(1.01);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        .btn-success {
            background: var(--gradient-3);
            box-shadow: 
                0 12px 30px rgba(0, 213, 143, 0.3),
                0 0 35px rgba(0, 213, 143, 0.2);
        }

        .btn-success:hover {
            box-shadow: 
                0 20px 40px rgba(0, 213, 143, 0.4),
                0 0 50px rgba(0, 213, 143, 0.3);
        }

        .btn-accent {
            background: var(--gradient-2);
            box-shadow: 
                0 12px 30px rgba(255, 101, 132, 0.3),
                0 0 35px rgba(255, 101, 132, 0.2);
        }

        .btn-accent:hover {
            box-shadow: 
                0 20px 40px rgba(255, 101, 132, 0.4),
                0 0 50px rgba(255, 101, 132, 0.3);
        }

        .btn-sm {
            padding: 10px 18px;
            font-size: 0.85rem;
        }

        /* Group Container - Modern Card */
        .group-container {
            background: rgba(20, 20, 30, 0.7);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            border: 1px solid rgba(108, 99, 255, 0.2);
            box-shadow: 
                0 20px 40px rgba(0, 0, 0, 0.2),
                0 0 40px rgba(108, 99, 255, 0.1);
            margin-bottom: 20px;
            overflow: hidden;
            animation: fadeIn 0.8s ease-out;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            max-height: 80px;
            position: relative;
        }

        .group-container.completed {
            border-color: rgba(0, 213, 143, 0.4);
            box-shadow: 
                0 20px 40px rgba(0, 0, 0, 0.2),
                0 0 40px rgba(0, 213, 143, 0.2);
        }

        .group-container.completed::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: var(--gradient-3);
            animation: shimmer 3s infinite linear;
        }

        .group-container.minimized {
            max-height: 80px;
            overflow: hidden;
        }

        .group-container.expanded {
            max-height: none;
        }

        .group-container.minimized .group-content {
            display: none;
        }

        .group-header {
            background: linear-gradient(90deg, 
                rgba(108, 99, 255, 0.1), 
                rgba(20, 20, 30, 0.2));
            padding: 25px 30px;
            border-bottom: 1px solid rgba(108, 99, 255, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            user-select: none;
            transition: all 0.3s;
        }

        .group-container.completed .group-header {
            background: linear-gradient(90deg, 
                rgba(0, 213, 143, 0.1), 
                rgba(20, 20, 30, 0.2));
        }

        .group-header:hover {
            background: linear-gradient(90deg, 
                rgba(108, 99, 255, 0.2), 
                rgba(20, 20, 30, 0.3));
        }

        .group-container.completed .group-header:hover {
            background: linear-gradient(90deg, 
                rgba(0, 213, 143, 0.2), 
                rgba(20, 20, 30, 0.3));
        }

        .group-title {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--text);
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .group-container.completed .group-title {
            color: var(--success);
        }

        .group-title i {
            color: var(--primary);
            transition: transform 0.3s;
            font-size: 1.3rem;
        }

        .group-container.completed .group-title i {
            color: var(--success);
        }

        .group-container.minimized .group-title i {
            transform: rotate(-90deg);
        }

        .group-stats {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .group-stat {
            background: rgba(20, 20, 30, 0.6);
            padding: 8px 15px;
            border-radius: 12px;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
            border: 1px solid rgba(108, 99, 255, 0.2);
            backdrop-filter: blur(5px);
        }

        .group-container.completed .group-stat {
            border-color: rgba(0, 213, 143, 0.2);
        }

        .completed-badge {
            background: var(--gradient-3) !important;
            color: white !important;
            border: none !important;
            animation: pulse 2s infinite;
            box-shadow: 0 0 20px rgba(0, 213, 143, 0.3);
        }

        .group-actions {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        /* Minimize Button */
        .minimize-btn {
            width: 40px;
            height: 40px;
            background: rgba(108, 99, 255, 0.1);
            border: 1px solid rgba(108, 99, 255, 0.2);
            color: var(--text);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 1.2rem;
            backdrop-filter: blur(5px);
        }

        .group-container.completed .minimize-btn {
            background: rgba(0, 213, 143, 0.1);
            border: 1px solid rgba(0, 213, 143, 0.2);
        }

        .minimize-btn:hover {
            background: var(--primary);
            transform: rotate(90deg);
            box-shadow: 0 10px 20px rgba(108, 99, 255, 0.3);
        }

        .group-container.completed .minimize-btn:hover {
            background: var(--success);
            box-shadow: 0 10px 20px rgba(0, 213, 143, 0.3);
        }

        .group-container.minimized .minimize-btn {
            transform: rotate(180deg);
        }

        .group-container.minimized .minimize-btn:hover {
            transform: rotate(270deg);
        }

        /* Group Content */
        .group-content {
            max-height: 500px;
            overflow-y: auto;
            transition: all 0.5s ease;
        }

        .group-container.minimized .group-content {
            max-height: 0;
            overflow: hidden;
        }

        /* Links Table */
        .links-table {
            width: 100%;
            border-collapse: collapse;
            color: var(--text);
        }

        .links-table th {
            padding: 20px 25px;
            text-align: left;
            font-weight: 600;
            color: var(--text);
            border-bottom: 2px solid rgba(108, 99, 255, 0.2);
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            background: rgba(20, 20, 30, 0.8);
        }

        .group-container.completed .links-table th {
            background: rgba(0, 213, 143, 0.1);
        }

        .links-table td {
            padding: 18px 25px;
            border-bottom: 1px solid rgba(108, 99, 255, 0.1);
            transition: all 0.3s;
        }

        .links-table tr {
            transition: all 0.3s;
        }

        .links-table tr:hover {
            background: rgba(108, 99, 255, 0.1);
            transform: scale(1.005);
        }

        .group-container.completed .links-table tr:hover {
            background: rgba(0, 213, 143, 0.1);
        }

        .url-cell {
            max-width: 300px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .url-cell a {
            color: var(--secondary);
            text-decoration: none;
            transition: all 0.3s;
            position: relative;
            padding-left: 25px;
            font-weight: 500;
        }

        .url-cell a::before {
            content: 'üîó';
            position: absolute;
            left: 0;
            opacity: 0.7;
        }

        .url-cell a:hover {
            color: var(--primary);
            text-decoration: underline;
        }

        .group-container.completed .url-cell a {
            color: var(--success);
        }

        .action-cell {
            white-space: nowrap;
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .action-btn {
            padding: 10px 18px;
            background: rgba(108, 99, 255, 0.1);
            border: 1px solid rgba(108, 99, 255, 0.2);
            color: var(--text);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-weight: 500;
            font-size: 0.9rem;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            backdrop-filter: blur(5px);
        }

        .action-btn:hover {
            background: var(--primary);
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(108, 99, 255, 0.3);
            border-color: var(--primary);
        }

        .group-container.completed .action-btn {
            background: rgba(0, 213, 143, 0.1);
            border: 1px solid rgba(0, 213, 143, 0.2);
        }

        .group-container.completed .action-btn:hover {
            background: var(--success);
            box-shadow: 0 10px 20px rgba(0, 213, 143, 0.3);
            border-color: var(--success);
        }

        .action-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        .copy-btn {
            background: rgba(255, 170, 0, 0.1);
            border: 1px solid rgba(255, 170, 0, 0.2);
        }

        .copy-btn:hover {
            background: var(--warning);
        }

        .copy-btn.copied {
            background: var(--success) !important;
            color: white !important;
            border-color: var(--success) !important;
        }

        .reopen-btn {
            background: rgba(0, 149, 255, 0.1);
            border: 1px solid rgba(0, 149, 255, 0.2);
        }
        
        .reopen-btn:hover {
            background: var(--info);
        }

        /* Progress Bar */
        .progress-container {
            width: 100%;
            background: rgba(20, 20, 30, 0.7);
            border-radius: 16px;
            margin: 20px 0;
            overflow: hidden;
            display: none;
            border: 1px solid rgba(108, 99, 255, 0.2);
            height: 40px;
            position: relative;
            backdrop-filter: blur(15px);
            box-shadow: 
                0 10px 30px rgba(0, 0, 0, 0.2),
                0 0 30px rgba(108, 99, 255, 0.1);
        }

        .progress-bar {
            height: 100%;
            background: var(--gradient-1);
            border-radius: 16px;
            width: 0%;
            transition: width 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
            position: relative;
            overflow: visible;
            display: flex;
            align-items: center;
            justify-content: flex-start;
            padding-left: 20px;
            color: white;
            font-weight: 600;
            font-size: 14px;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
        }

        .progress-text {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text);
            font-weight: 600;
            font-size: 14px;
            z-index: 1;
            pointer-events: none;
        }

        .progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            width: 100%;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255,255,255,0.2), 
                transparent);
            animation: shimmerProgress 1.5s infinite;
        }

        /* Loading Animation */
        .loading {
            text-align: center;
            padding: 80px;
            background: rgba(20, 20, 30, 0.8);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            border: 1px solid rgba(108, 99, 255, 0.2);
            box-shadow: 
                0 20px 40px rgba(0, 0, 0, 0.3),
                0 0 40px rgba(108, 99, 255, 0.2);
        }

        .spinner {
            width: 80px;
            height: 80px;
            border: 5px solid rgba(108, 99, 255, 0.2);
            border-top: 5px solid var(--primary);
            border-radius: 50%;
            margin: 0 auto 30px;
            animation: spin 1s linear infinite, pulse 2s infinite;
            box-shadow: 0 0 30px rgba(108, 99, 255, 0.3);
        }

        .loading p {
            font-size: 1.3rem;
            color: var(--text-muted);
            font-weight: 500;
        }

        .loading-method {
            margin-top: 20px;
            padding: 15px;
            background: rgba(108, 99, 255, 0.1);
            border-radius: 12px;
            font-size: 1rem;
            color: var(--text-muted);
            border: 1px solid rgba(108, 99, 255, 0.2);
            backdrop-filter: blur(5px);
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 60px;
            color: var(--text-muted);
            background: rgba(20, 20, 30, 0.8);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            border: 1px solid rgba(108, 99, 255, 0.2);
        }

        .empty-state i {
            font-size: 4rem;
            margin-bottom: 25px;
            opacity: 0.5;
        }

        /* Footer */
        .footer {
            text-align: center;
            padding: 30px;
            margin-top: 40px;
            color: var(--text-muted);
            font-size: 0.9rem;
            border-top: 1px solid rgba(108, 99, 255, 0.2);
            background: rgba(20, 20, 30, 0.7);
            backdrop-filter: blur(15px);
            border-radius: 16px;
        }

        .footer a {
            color: var(--secondary);
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s;
        }

        .footer a:hover {
            color: var(--primary);
            text-decoration: underline;
        }

        /* Notification */
        .notification {
            position: fixed;
            top: 25px;
            right: 25px;
            padding: 20px 25px;
            border-radius: 16px;
            color: white;
            font-weight: 600;
            z-index: 1000;
            max-width: 350px;
            transform: translateX(120%);
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 
                0 15px 35px rgba(0, 0, 0, 0.3),
                0 0 40px rgba(108, 99, 255, 0.2);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            background: var(--gradient-3);
        }

        .notification.error {
            background: var(--gradient-2);
        }

        .notification.info {
            background: linear-gradient(135deg, #0095FF 0%, #6C63FF 100%);
        }

        .notification.warning {
            background: linear-gradient(135deg, #FFAA00 0%, #FF6584 100%);
        }

        /* Connection Status */
        .connection-status {
            position: fixed;
            bottom: 25px;
            right: 25px;
            padding: 12px 20px;
            border-radius: 16px;
            font-size: 0.9rem;
            font-weight: 600;
            z-index: 100;
            display: flex;
            align-items: center;
            gap: 10px;
            backdrop-filter: blur(15px);
            transition: all 0.3s;
            box-shadow: 
                0 10px 30px rgba(0, 0, 0, 0.2),
                0 0 30px rgba(108, 99, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .connection-status.online {
            background: rgba(0, 213, 143, 0.2);
            color: var(--success);
        }

        .connection-status.offline {
            background: rgba(255, 61, 113, 0.2);
            color: var(--danger);
        }

        .connection-status i {
            font-size: 1.1rem;
        }

        /* Animations */
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes fadeInUp {
            from { 
                opacity: 0; 
                transform: translateY(40px);
            }
            to { 
                opacity: 1; 
                transform: translateY(0);
            }
        }

        @keyframes slideDown {
            from { 
                opacity: 0; 
                transform: translateY(-40px);
            }
            to { 
                opacity: 1; 
                transform: translateY(0);
            }
        }

        @keyframes shimmer {
            0% { background-position: -200px 0; }
            100% { background-position: 200px 0; }
        }

        @keyframes shimmer-bg {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        @keyframes shimmer-card {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        @keyframes shimmerProgress {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        @keyframes btn-shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* Responsive Design */
        @media (max-width: 1200px) {
            .container {
                padding: 15px;
            }
            
            .header {
                padding: 30px;
            }
            
            .header h1 {
                font-size: 2.5rem;
            }
        }

        @media (max-width: 992px) {
            .stats {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
            }
            
            .stat-box {
                padding: 10px 12px;
            }
            
            .stat-value {
                font-size: 1.3rem;
            }
            
            .stat-icon {
                width: 35px;
                height: 35px;
                font-size: 1rem;
            }
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .header p {
                font-size: 1rem;
            }
            
            .logo {
                width: 60px;
                height: 60px;
                font-size: 1.8rem;
            }
            
            .buttons {
                flex-direction: column;
                align-items: stretch;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
            
            .group-header {
                flex-direction: column;
                gap: 15px;
                padding: 20px;
                text-align: center;
            }
            
            .group-stats {
                justify-content: center;
                flex-wrap: wrap;
            }
            
            .group-actions {
                width: 100%;
                justify-content: center;
                flex-wrap: wrap;
            }
            
            .links-table {
                display: block;
                overflow-x: auto;
            }
            
            .links-table th,
            .links-table td {
                padding: 15px;
            }
            
            .action-cell {
                flex-direction: column;
                gap: 8px;
            }
            
            .action-btn {
                width: 100%;
                justify-content: center;
            }
        }

        @media (max-width: 480px) {
            .stats {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .header {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 1.8rem;
            }
            
            .status-content {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
            
            .status-icon {
                width: 40px;
                height: 40px;
                font-size: 1.2rem;
            }
            
            .notification {
                right: 15px;
                left: 15px;
                max-width: none;
            }
        }
    </style>
</head>
<body>
    <!-- Background Effects -->
    <div class="neon-glow">
        <div class="glow-1"></div>
        <div class="glow-2"></div>
        <div class="glow-3"></div>
    </div>
    
    <div class="grid-pattern"></div>
    
    <div class="floating-elements">
        <div class="float-element"></div>
        <div class="float-element"></div>
        <div class="float-element"></div>
    </div>

    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="logo-container">
                <div class="logo">üìä</div>
                <div>
                    <h1>LINK LINETOGEL</h1>
                   
                </div>
            </div>
        </div>

        <!-- Status -->
        <div id="status" class="status">
            <div class="status-content">
                <div class="status-icon" id="statusIcon">‚è≥</div>
                <div id="statusText">Menyiapkan pembacaan data dari Google Sheets...</div>
                <span id="connectionMethod" class="connection-method">Direct</span>
            </div>
            <div id="ipInfo" class="ip-info">
                <i class="fas fa-globe"></i>
                <span>Mendeteksi IP dan lokasi...</span>
            </div>
        </div>

        <!-- Stats -->
        <div class="stats">
            <div class="stat-box">
                <div class="stat-icon">üìÅ</div>
                <div class="stat-info">
                    <div class="stat-value" id="totalGroups">0</div>
                    <div class="stat-label">Kelompok</div>
                </div>
            </div>
            <div class="stat-box">
                <div class="stat-icon">üìà</div>
                <div class="stat-info">
                    <div class="stat-value" id="totalLinks">0</div>
                    <div class="stat-label">Total Link</div>
                </div>
            </div>
            <div class="stat-box">
                <div class="stat-icon">‚úÖ</div>
                <div class="stat-info">
                    <div class="stat-value" id="validLinks">0</div>
                    <div class="stat-label">Link Valid</div>
                </div>
            </div>
            <div class="stat-box">
                <div class="stat-icon">üöÄ</div>
                <div class="stat-info">
                    <div class="stat-value" id="openedLinks">0</div>
                    <div class="stat-label">Terbuka</div>
                </div>
            </div>
        </div>

        <!-- Search -->
        <div class="search-container">
            <i class="fas fa-search search-icon"></i>
            <input type="text" id="searchInput" class="search-input" placeholder="Cari Judul atau URL...">
            <button id="clearSearchBtn" class="clear-search-btn" title="Hapus Pencarian">
                <i class="fas fa-times"></i>
            </button>
        </div>

        <!-- Progress Bar -->
        <div class="progress-container" id="progressContainer">
            <div class="progress-text" id="progressText">0% (0/0)</div>
            <div class="progress-bar" id="progressBar"></div>
        </div>

        <!-- Buttons -->
        <div class="buttons">
            <button class="btn" onclick="loadData()" id="loadBtn">
                <i class="fas fa-sync-alt"></i> Muat Ulang Data
            </button>
            <button class="btn btn-success" onclick="openAllLinks()" id="openAllBtn">
                <i class="fas fa-rocket"></i> Buka Semua Link Baru
            </button>
            <button class="btn btn-accent" onclick="openAllIncludingOpened()" id="openAllIncludingBtn">
                <i class="fas fa-play-circle"></i> Buka Semua Link
            </button>
            <button class="btn" onclick="copyAllLinks()" id="copyAllBtn">
                <i class="fas fa-copy"></i> Salin Semua Link
            </button>
        </div>

        <!-- Loading -->
        <div id="loading" class="loading">
            <div class="spinner"></div>
            <p>Memuat dan mengelompokkan data</p>
            <div id="loadingMethod" class="loading-method" style="display: none;">
                Metode: <span id="currentMethod">Direct</span>
            </div>
        </div>

        <!-- Groups Container -->
        <div id="groupsContainer" style="display: none;"></div>

        <!-- Footer -->
        <div class="footer">
            <p></p>
        </div>
    </div>

    <!-- Hidden iframe -->
    <iframe id="hiddenIframe" style="display: none;"></iframe>

    <!-- Notification Container -->
    <div id="notificationContainer"></div>

    <!-- Connection Status -->
    <div id="connectionStatus" class="connection-status">
        <i class="fas fa-wifi"></i>
        <span id="connectionStatusText">Checking...</span>
    </div>

    <script>
        // ========== KONFIGURASI ==========
        const SHEET_ID = '1y1QhLRaV5wZo-B_JbFLSFC5-5zSkbewiKe40bw80ytE';
        const SHEET_NAME = 'CHECK AKSES LINK';

        // ========== VARIABEL GLOBAL ==========
        let groups = [];
        let isProcessing = false;
        let openAllTimeout = null;
        let firstLoad = true;
        let userIP = '';
        let userLocation = '';
        let lastDataLoadTime = null;
        let dataCache = null;
        const cacheExpiryTime = 5 * 60 * 1000; // 5 menit
        let currentConnectionMethod = 'Direct';
        let isOnline = navigator.onLine;

        // ========== FUNGSI BANTU ==========

        /**
         * Menampilkan notifikasi
         */
        function showNotification(message, type = 'info', duration = 5000) {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <div style="display: flex; align-items: center; gap: 12px;">
                    <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : type === 'warning' ? 'exclamation-triangle' : 'info-circle'}"></i>
                    <span>${message}</span>
                </div>
            `;
            
            document.getElementById('notificationContainer').appendChild(notification);
            
            setTimeout(() => {
                notification.classList.add('show');
            }, 100);
            
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => {
                    notification.remove();
                }, 300);
            }, duration);
        }

        /**
         * Memperbarui status koneksi
         */
        function updateConnectionStatus(status, text) {
            const statusElement = document.getElementById('connectionStatus');
            const textElement = document.getElementById('connectionStatusText');
            
            statusElement.className = `connection-status ${status}`;
            textElement.textContent = text;
        }

        /**
         * Memperbarui status utama
         */
        function updateStatus(message, type = 'info', method = null) {
            const status = document.getElementById('status');
            const icon = document.getElementById('statusIcon');
            const text = document.getElementById('statusText');
            const methodElement = document.getElementById('connectionMethod');

            text.textContent = message;

            if (method) {
                methodElement.textContent = method;
                methodElement.className = `connection-method ${method.toLowerCase().replace(' ', '-')}`;
                currentConnectionMethod = method;
            }

            if (type === 'success') {
                status.className = 'status success';
                icon.textContent = '‚úÖ';
            } else if (type === 'error') {
                status.className = 'status error';
                icon.textContent = '‚ùå';
            } else {
                status.className = 'status';
                icon.textContent = '‚è≥';
            }

            status.style.animation = 'none';
            setTimeout(() => {
                status.style.animation = 'fadeIn 0.5s ease-out';
            }, 10);
        }

        /**
         * Memperbarui info IP
         */
        function updateIPInfo(ip, location) {
            const ipInfo = document.getElementById('ipInfo');
            if (ip && location) {
                ipInfo.innerHTML = `<i class="fas fa-globe"></i> IP: ${ip} | Lokasi: ${location}`;
            } else if (ip) {
                ipInfo.innerHTML = `<i class="fas fa-globe"></i> IP: ${ip}`;
            }
        }

        /**
         * Mendapatkan IP dan lokasi pengguna
         */
        async function getIPInfo() {
            try {
                const ipServices = [
                    { 
                        url: 'https://ipapi.co/json/', 
                        name: 'IPAPI',
                        parseLocation: (data) => {
                            if (data.city && data.region && data.country_name) {
                                return `${data.city}, ${data.region}, ${data.country_name}`;
                            } else if (data.city && data.country_name) {
                                return `${data.city}, ${data.country_name}`;
                            } else if (data.country_name) {
                                return data.country_name;
                            }
                            return null;
                        }
                    },
                    { 
                        url: 'https://ipinfo.io/json', 
                        name: 'IPInfo',
                        parseLocation: (data) => {
                            if (data.city && data.region && data.country) {
                                return `${data.city}, ${data.region}, ${data.country}`;
                            } else if (data.city && data.country) {
                                return `${data.city}, ${data.country}`;
                            } else if (data.country) {
                                return data.country;
                            }
                            return null;
                        }
                    }
                ];

                let ipData = null;
                let serviceUsed = null;
                let detectedLocation = null;

                for (const service of ipServices) {
                    try {
                        const response = await fetch(service.url, {
                            signal: AbortSignal.timeout(8000)
                        });
                        
                        if (response.ok) {
                            const data = await response.json();
                            
                            const ip = data.ip || data.ip_address || data.query || 'Tidak terdeteksi';
                            const location = service.parseLocation ? service.parseLocation(data) : null;
                            
                            if (ip && ip !== 'Tidak terdeteksi') {
                                ipData = { ip, location };
                                serviceUsed = service.name;
                                detectedLocation = location;
                                
                                if (location) {
                                    break;
                                }
                            }
                        }
                    } catch (error) {
                        continue;
                    }
                }

                if (ipData && !detectedLocation) {
                    const locationServices = [
                        'https://ipapi.co/json/',
                        'https://ipinfo.io/json',
                        'https://freeipapi.com/api/json/'
                    ];
                    
                    for (const serviceUrl of locationServices) {
                        try {
                            const response = await fetch(serviceUrl, {
                                signal: AbortSignal.timeout(5000)
                            });
                            
                            if (response.ok) {
                                const data = await response.json();
                                
                                detectedLocation = 
                                    (data.city && data.region && data.country_name) ? `${data.city}, ${data.region}, ${data.country_name}` :
                                    (data.city && data.region && data.country) ? `${data.city}, ${data.region}, ${data.country}` :
                                    (data.cityName && data.regionName && data.countryName) ? `${data.cityName}, ${data.regionName}, ${data.countryName}` :
                                    (data.city && data.country_name) ? `${data.city}, ${data.country_name}` :
                                    (data.city && data.country) ? `${data.city}, ${data.country}` :
                                    (data.cityName && data.countryName) ? `${data.cityName}, ${data.countryName}` :
                                    data.country_name || data.country || data.countryName || null;
                                
                                if (detectedLocation) {
                                    break;
                                }
                            }
                        } catch (error) {
                            continue;
                        }
                    }
                }

                if (ipData) {
                    userIP = ipData.ip;
                    userLocation = detectedLocation || 'Lokasi tidak terdeteksi';
                    
                    updateIPInfo(userIP, userLocation);
                    updateStatus(`IP berhasil dideteksi (${serviceUsed})`, 'success');
                    
                    return true;
                }
                
                throw new Error('All IP services failed');
            } catch (error) {
                try {
                    const response = await fetch('https://api.ipify.org?format=json', {
                        signal: AbortSignal.timeout(5000)
                    });
                    
                    if (response.ok) {
                        const data = await response.json();
                        userIP = data.ip || 'Tidak terdeteksi';
                        userLocation = 'Lokasi tidak tersedia';
                        updateIPInfo(userIP, userLocation);
                        updateStatus('IP berhasil dideteksi (Fallback)', 'success');
                        return true;
                    }
                } catch (fallbackError) {
                    console.error('Fallback IP detection failed:', fallbackError);
                }
                
                updateIPInfo('Error', 'Gagal mendeteksi');
                updateStatus('Gagal mendeteksi IP', 'error');
                return false;
            }
        }

        /**
         * Memperbarui progress bar
         */
        function updateProgress(current, total) {
            const progressContainer = document.getElementById('progressContainer');
            const progressBar = document.getElementById('progressBar');
            const progressText = document.getElementById('progressText');

            const percentage = Math.round((current / total) * 100);
            progressBar.style.width = `${percentage}%`;
            progressText.textContent = `${percentage}% (${current}/${total})`;

            if (current < total) {
                progressContainer.style.display = 'flex';
            } else {
                setTimeout(() => {
                    progressContainer.style.display = 'none';
                }, 1000);
            }
        }

        /**
         * Memformat URL dengan menambahkan https:// jika perlu
         */
        function formatUrl(url) {
            if (!url || typeof url !== 'string') return '';

            let cleanUrl = url.trim();
            cleanUrl = cleanUrl.replace(/^["']|["']$/g, '');

            if (!cleanUrl.startsWith('http://') && !cleanUrl.startsWith('https://')) {
                cleanUrl = 'https://' + cleanUrl;
            }

            return cleanUrl;
        }

        /**
         * Parsing CSV sederhana
         */
        function parseCSV(csv) {
            const lines = [];
            const rows = csv.split(/\r\n|\n/);
            
            for (let row of rows) {
                if (row.trim()) {
                    const cells = [];
                    let current = '';
                    let inQuotes = false;
                    
                    for (let i = 0; i < row.length; i++) {
                        const char = row[i];
                        const nextChar = row[i + 1];
                        
                        if (char === '"' && inQuotes && nextChar === '"') {
                            current += '"';
                            i++;
                        } else if (char === '"') {
                            inQuotes = !inQuotes;
                        } else if (char === ',' && !inQuotes) {
                            cells.push(current.trim());
                            current = '';
                        } else {
                            current += char;
                        }
                    }
                    
                    cells.push(current.trim());
                    lines.push(cells);
                }
            }
            
            return lines;
        }

        /**
         * Mengelompokkan link berdasarkan judul (title)
         */
        function groupLinksByTitle(links) {
            const groupsMap = {};

            links.forEach((link, index) => {
                let title = link.title || 'TANPA JUDUL';
                title = title.trim().toUpperCase();

                if (!groupsMap[title]) {
                    groupsMap[title] = {
                        id: Object.keys(groupsMap).length,
                        title: title,
                        links: []
                    };
                }

                groupsMap[title].links.push({
                    ...link,
                    id: `${title}-${groupsMap[title].links.length}`
                });
            });

            return Object.values(groupsMap);
        }

        // ========== FUNGSI UTAMA LOAD DATA ==========
        async function loadData() {
            try {
                document.getElementById('loading').style.display = 'block';
                document.getElementById('groupsContainer').style.display = 'none';
                updateStatus('Memuat dan mengelompokkan data dari Google Sheets...');

                const now = new Date().getTime();
                if (dataCache && lastDataLoadTime && (now - lastDataLoadTime < cacheExpiryTime)) {
                    console.log('Using cached data');
                    groups = dataCache;
                    updateStats();
                    displayGroups();
                    document.getElementById('loading').style.display = 'none';
                    document.getElementById('groupsContainer').style.display = 'block';
                    updateStatus(`Berhasil memuat ${groups.length} kelompok dari cache`, 'success');
                    animateStats();
                    
                    if (firstLoad) {
                        setTimeout(() => {
                            minimizeAll();
                            firstLoad = false;
                        }, 100);
                    }
                    return;
                }

                const sheetUrl = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:csv&sheet=${encodeURIComponent(SHEET_NAME)}`;
                
                const response = await fetch(sheetUrl, {
                    headers: {
                        'Accept': 'text/csv',
                        'Cache-Control': 'no-cache'
                    },
                    signal: AbortSignal.timeout(10000)
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const csvData = await response.text();
                const rows = parseCSV(csvData);
                
                let startRow = 0;
                for (let i = 0; i < rows.length; i++) {
                    if (rows[i].some(cell => cell && (cell.includes('http') || cell.includes('CHECK')))) {
                        startRow = i;
                        break;
                    }
                }
                
                if (startRow === 0) startRow = 6;
                
                const dataRows = rows.slice(startRow);
                const allLinks = [];
                const seenUrls = new Set();

                dataRows.forEach((row, index) => {
                    if (row.length >= 2) {
                        const urlRaw = row[0] || '';
                        const title = row[1] || `Link ${index + 1}`;

                        if (urlRaw.trim()) {
                            const url = formatUrl(urlRaw);
                            const urlKey = url.toLowerCase();
                            const isDuplicate = seenUrls.has(urlKey);
                            
                            if (!isDuplicate) {
                                seenUrls.add(urlKey);
                            }

                            allLinks.push({
                                id: index,
                                title: title,
                                url: url,
                                isValid: url.startsWith('http'),
                                isDuplicate: isDuplicate,
                                opened: false,
                                lastOpened: null
                            });
                        }
                    }
                });

                groups = groupLinksByTitle(allLinks);
                dataCache = groups;
                lastDataLoadTime = new Date().getTime();
                
                updateStats();
                displayGroups();

                document.getElementById('loading').style.display = 'none';
                document.getElementById('groupsContainer').style.display = 'block';

                updateStatus(`Berhasil memuat ${groups.length} kelompok dengan total ${groups.reduce((sum, g) => sum + g.links.length, 0)} link`, 'success', 'Direct');
                showNotification(`Berhasil memuat ${groups.length} kelompok`, 'success');
                
                animateStats();

                if (firstLoad) {
                    setTimeout(() => {
                        minimizeAll();
                        firstLoad = false;
                    }, 100);
                }

            } catch (error) {
                console.error('Error loading data:', error);
                
                if (dataCache) {
                    console.log('Using expired cached data as fallback');
                    groups = dataCache;
                    updateStats();
                    displayGroups();
                    document.getElementById('loading').style.display = 'none';
                    document.getElementById('groupsContainer').style.display = 'block';
                    updateStatus(`Menggunakan data cache yang kadaluarsa. ${groups.length} kelompok.`, 'error');
                    showNotification('Menggunakan data cache yang kadaluarsa. Beberapa informasi mungkin tidak terkini.', 'error', 8000);
                    
                    if (firstLoad) {
                        setTimeout(() => {
                            minimizeAll();
                            firstLoad = false;
                        }, 100);
                    }
                    return;
                }
                
                document.getElementById('loading').style.display = 'none';
                
                const groupsContainer = document.getElementById('groupsContainer');
                
                const errorMessage = `
                    <div class="empty-state">
                        <i class="fas fa-exclamation-triangle"></i>
                        <h3>Gagal Memuat Data</h3>
                        <p>Error: ${error.message}</p>
                        <p>Pastikan:</p>
                        <ul style="text-align: left; margin-top: 10px;">
                            <li>Google Sheet sudah di-publikasikan (File > Share > Publish to web)</li>
                            <li>Koneksi internet stabil</li>
                            <li>Sheet ID dan nama sheet benar</li>
                        </ul>
                        <button class="btn" onclick="loadData()" style="margin-top: 20px;">
                            <i class="fas fa-redo"></i> Coba Lagi
                        </button>
                    </div>
                `;
                
                groupsContainer.innerHTML = errorMessage;
                groupsContainer.style.display = 'block';
            }
        }

        /**
         * Memperbarui statistik
         */
        function updateStats() {
            let totalLinks = 0;
            let validLinks = 0;
            let openedLinks = 0;

            groups.forEach(group => {
                totalLinks += group.links.length;
                validLinks += group.links.filter(l => l.isValid && !l.isDuplicate).length;
                openedLinks += group.links.filter(l => l.opened).length;
            });

            document.getElementById('totalGroups').textContent = groups.length;
            document.getElementById('totalLinks').textContent = totalLinks;
            document.getElementById('validLinks').textContent = validLinks;
            document.getElementById('openedLinks').textContent = openedLinks;
        }

        /**
         * Animasi statistik saat pertama dimuat
         */
        function animateStats() {
            const stats = ['totalGroups', 'totalLinks', 'validLinks', 'openedLinks'];
            
            stats.forEach((stat) => {
                const element = document.getElementById(stat);
                const target = parseInt(element.textContent);
                let current = 0;
                const increment = target / 30;

                const timer = setInterval(() => {
                    current += increment;
                    if (current >= target) {
                        current = target;
                        clearInterval(timer);
                    }
                    element.textContent = Math.round(current);
                }, 30);
            });
        }

        /**
         * Menampilkan grup-grup link
         */
        function displayGroups() {
            const groupsContainer = document.getElementById('groupsContainer');
            groupsContainer.innerHTML = '';

            if (groups.length === 0) {
                groupsContainer.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-folder-open"></i>
                        <h3>Tidak ada kelompok data ditemukan</h3>
                        <p>Data dari Google Sheets kosong atau tidak dapat diakses</p>
                    </div>
                `;
                return;
            }

            let completedGroupsCount = 0;

            groups.forEach((group, groupIndex) => {
                const totalLinks = group.links.length;
                const validLinks = group.links.filter(l => l.isValid && !l.isDuplicate).length;
                const openedLinks = group.links.filter(l => l.opened).length;
                const allOpened = validLinks > 0 && openedLinks === validLinks;

                if (allOpened) {
                    completedGroupsCount++;
                }

                const groupElement = document.createElement('div');
                groupElement.className = `group-container minimized ${allOpened ? 'completed' : ''}`;
                groupElement.style.animation = `fadeInUp 0.5s ease-out ${groupIndex * 0.1}s both`;
                groupElement.dataset.groupIndex = groupIndex;

                groupElement.innerHTML = `
                    <div class="group-header" onclick="toggleGroup(${groupIndex})">
                        <div class="group-title">
                            <i class="fas fa-folder${allOpened ? '-open' : ''}"></i>
                            ${group.title}
                            ${allOpened ? '<span style="margin-left: 10px; font-size: 0.8rem; color: var(--success);">‚úì SELESAI</span>' : ''}
                        </div>
                        <div class="group-stats">
                            <span class="group-stat">
                                <i class="fas fa-link"></i> ${totalLinks}
                            </span>
                            <span class="group-stat">
                                <i class="fas fa-check-circle"></i> ${validLinks}
                            </span>
                            <span class="group-stat">
                                <i class="fas fa-rocket"></i> ${openedLinks}
                            </span>
                            ${allOpened ? '<span class="group-stat completed-badge"><i class="fas fa-check-double"></i> Selesai</span>' : ''}
                        </div>
                        <div class="group-actions">
                            <button class="btn btn-sm btn-success" onclick="openAllLinksInGroup(${groupIndex}); event.stopPropagation();">
                                <i class="fas fa-play-circle"></i> Buka Baru
                            </button>
                            <button class="btn btn-sm btn-accent" onclick="openAllIncludingOpenedInGroup(${groupIndex}); event.stopPropagation();">
                                <i class="fas fa-redo"></i> Buka Semua
                            </button>
                            <button class="btn btn-sm" onclick="copyGroupLinks(${groupIndex}); event.stopPropagation();">
                                <i class="fas fa-copy"></i> Salin
                            </button>
                            <button class="minimize-btn" onclick="toggleGroup(${groupIndex}); event.stopPropagation();">
                                <i class="fas fa-chevron-down"></i>
                            </button>
                        </div>
                    </div>
                    <div class="group-content">
                        <table class="links-table">
                            <thead>
                                <tr>
                                    <th>URL</th>
                                    <th width="120">Status</th>
                                    <th width="200">Aksi</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${group.links.map((link, linkIndex) => `
                                    <tr>
                                        <td class="url-cell">
                                            <a href="${link.url}" target="_blank" title="${link.url}" onclick="openSingleLink(${groupIndex}, ${linkIndex}); return false;">
                                                ${link.url.replace(/^https?:\/\//, '').substring(0, 50)}
                                                ${link.url.length > 50 ? '...' : ''}
                                            </a>
                                        </td>
                                        <td>
                                            ${getStatusBadge(link)}
                                        </td>
                                        <td class="action-cell">
                                            <button class="action-btn open-btn" onclick="openSingleLink(${groupIndex}, ${linkIndex})" 
                                                ${link.isDuplicate || !link.isValid ? 'disabled' : ''}>
                                                <i class="fas fa-external-link-alt"></i> ${link.opened ? 'Buka Lagi' : 'Buka'}
                                            </button>
                                            <button class="action-btn copy-btn" onclick="copyLink(${groupIndex}, ${linkIndex}, this)" data-copied="false">
                                                <i class="fas fa-copy"></i> Salin
                                            </button>
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                `;

                groupsContainer.appendChild(groupElement);
            });

            if (completedGroupsCount > 0) {
                updateStatus(`${completedGroupsCount} dari ${groups.length} kelompok telah selesai dibuka`, 'success');
            }
        }

        /**
         * Mendapatkan badge status untuk link
         */
        function getStatusBadge(link) {
            if (link.isDuplicate) {
                return `<span style="color: #94a3b8; font-weight: 500; display: flex; align-items: center; gap:5px;">
                    <i class="fas fa-copy"></i> Duplikat
                </span>`;
            } else if (!link.isValid) {
                return `<span style="color: var(--danger); font-weight: 500; display: flex; align-items: center; gap:5px;">
                    <i class="fas fa-times-circle"></i> Tidak Valid
                </span>`;
            } else if (link.opened) {
                const lastOpenedText = link.lastOpened ? 
                    `<br><small style="font-size: 0.7rem; opacity: 0.8;">Terakhir: ${new Date(link.lastOpened).toLocaleTimeString()}</small>` : '';
                return `<span style="color: var(--success); font-weight: 500; display: flex; align-items: center; gap:5px;">
                    <i class="fas fa-check-circle"></i> Terbuka${lastOpenedText}
                </span>`;
            } else {
                return `<span style="color: var(--warning); font-weight: 500; display: flex; align-items: center; gap:5px;">
                    <i class="fas fa-clock"></i> Menunggu
                </span>`;
            }
        }

        /**
         * Men-toggle tampilan grup (minimize/expand)
         */
        window.toggleGroup = function(groupIndex) {
            const groupElement = document.querySelector(`.group-container[data-group-index="${groupIndex}"]`);
            if (groupElement) {
                const isMinimized = groupElement.classList.contains('minimized');

                if (isMinimized) {
                    groupElement.classList.remove('minimized');
                    groupElement.classList.add('expanded');

                    const icon = groupElement.querySelector('.minimize-btn i');
                    if (icon) icon.className = 'fas fa-chevron-up';

                    updateStatus(`Kelompok "${groups[groupIndex].title}" diexpand`, 'success');
                } else {
                    groupElement.classList.add('minimized');
                    groupElement.classList.remove('expanded');

                    const icon = groupElement.querySelector('.minimize-btn i');
                    if (icon) icon.className = 'fas fa-chevron-down';

                    updateStatus(`Kelompok "${groups[groupIndex].title}" diminimized`, 'success');
                }
            }
        };

        /**
         * Meminimalkan semua grup
         */
        function minimizeAll() {
            document.querySelectorAll('.group-container').forEach(group => {
                group.classList.add('minimized');
                group.classList.remove('expanded');
                const icon = group.querySelector('.minimize-btn i');
                if (icon) icon.className = 'fas fa-chevron-down';
            });
        }

        // ========== FUNGSI PEMBUKAAN LINK DENGAN BATCH PROCESSING (KECEPATAN TINGGI) ==========

        /**
         * Membuka link dalam batch (kelompok) dengan jeda antar batch
         * @param {Array} linksToOpen - array objek { url, groupIndex }
         * @param {Function} onProgressUpdate - callback (processed, total)
         * @param {Function} onComplete - callback setelah selesai
         */
        async function openLinksBatch(linksToOpen, onProgressUpdate, onComplete) {
            const batchSize = 10;          // jumlah link per batch
            const delayBetweenBatches = 5;  // jeda antar batch (ms)
            let processed = 0;
            const total = linksToOpen.length;

            for (let i = 0; i < total; i += batchSize) {
                const batch = linksToOpen.slice(i, i + batchSize);

                // Buka semua link dalam batch secara bersamaan
                batch.forEach(item => {
                    try {
                        window.open(item.url, '_blank', 'noopener,noreferrer');
                        // Tandai sebagai opened
                        const group = groups[item.groupIndex];
                        const linkIndex = group.links.findIndex(l => l.url === item.url);
                        if (linkIndex !== -1) {
                            group.links[linkIndex].opened = true;
                            group.links[linkIndex].lastOpened = new Date().toISOString();
                        }
                    } catch (e) {
                        console.error('Error opening link:', e);
                    }
                });

                processed = Math.min(i + batchSize, total);
                if (onProgressUpdate) onProgressUpdate(processed, total);

                // Update stats secara periodik (setiap 50 link atau di akhir)
                if (processed % 50 === 0 || processed === total) {
                    updateStats();
                }

                // Delay antar batch (kecuali batch terakhir)
                if (i + batchSize < total) {
                    await new Promise(resolve => setTimeout(resolve, delayBetweenBatches));
                }
            }

            // Final update tampilan
            displayGroups();
            updateProgress(total, total);
            if (onComplete) onComplete();
        }

        /**
         * Membuka semua link baru (belum dibuka) dalam satu grup
         */
        window.openAllLinksInGroup = async function(groupIndex) {
            if (isProcessing) return;

            const group = groups[groupIndex];
            const validLinks = group.links.filter(l => l.isValid && !l.isDuplicate && !l.opened);
            if (validLinks.length === 0) {
                updateStatus(`Tidak ada link baru yang bisa dibuka di kelompok "${group.title}"`, 'error');
                showNotification(`Tidak ada link baru yang bisa dibuka di kelompok "${group.title}"`, 'error');
                return;
            }

            isProcessing = true;
            const openBtn = document.querySelector(`.group-container[data-group-index="${groupIndex}"] .btn-success`);
            const originalHTML = openBtn.innerHTML;
            openBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Membuka...';
            openBtn.disabled = true;

            updateStatus(`Membuka ${validLinks.length} link baru di kelompok "${group.title}"...`);
            updateProgress(0, validLinks.length);

            const linksToOpen = validLinks.map(link => ({
                url: link.url,
                groupIndex: groupIndex,
            }));

            await openLinksBatch(linksToOpen, (processed, total) => {
                updateProgress(processed, total);
            }, () => {
                updateStatus(`Berhasil membuka ${validLinks.length} link baru di kelompok "${group.title}"`, 'success');
                showNotification(`Berhasil membuka ${validLinks.length} link baru di kelompok "${group.title}"`, 'success');
                isProcessing = false;
                openBtn.innerHTML = '<i class="fas fa-play-circle"></i> Buka Baru';
                openBtn.disabled = false;
            });
        };

        /**
         * Membuka semua link (termasuk yang sudah dibuka) dalam satu grup
         */
        window.openAllIncludingOpenedInGroup = async function(groupIndex) {
            if (isProcessing) return;

            const group = groups[groupIndex];
            const validLinks = group.links.filter(l => l.isValid && !l.isDuplicate);
            if (validLinks.length === 0) {
                updateStatus(`Tidak ada link yang bisa dibuka di kelompok "${group.title}"`, 'error');
                showNotification(`Tidak ada link yang bisa dibuka di kelompok "${group.title}"`, 'error');
                return;
            }

            isProcessing = true;
            const openBtn = document.querySelector(`.group-container[data-group-index="${groupIndex}"] .btn-accent`);
            const originalHTML = openBtn.innerHTML;
            openBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Membuka...';
            openBtn.disabled = true;

            updateStatus(`Membuka ${validLinks.length} link di kelompok "${group.title}" (termasuk yang sudah dibuka)...`);
            updateProgress(0, validLinks.length);

            const linksToOpen = validLinks.map(link => ({
                url: link.url,
                groupIndex: groupIndex,
            }));

            await openLinksBatch(linksToOpen, (processed, total) => {
                updateProgress(processed, total);
            }, () => {
                updateStatus(`Berhasil membuka ${validLinks.length} link di kelompok "${group.title}"`, 'success');
                showNotification(`Berhasil membuka ${validLinks.length} link di kelompok "${group.title}"`, 'success');
                isProcessing = false;
                openBtn.innerHTML = '<i class="fas fa-redo"></i> Buka Semua';
                openBtn.disabled = false;
            });
        };

        /**
         * Membuka semua link baru (belum dibuka) dari semua grup
         */
        async function openAllLinks() {
            if (isProcessing) return;

            let allValidLinks = [];
            groups.forEach((group, gIndex) => {
                group.links.forEach(link => {
                    if (link.isValid && !link.isDuplicate && !link.opened) {
                        allValidLinks.push({
                            url: link.url,
                            groupIndex: gIndex,
                        });
                    }
                });
            });

            if (allValidLinks.length === 0) {
                updateStatus('Tidak ada link baru yang bisa dibuka', 'error');
                showNotification('Tidak ada link baru yang bisa dibuka', 'error');
                return;
            }

            isProcessing = true;
            const openAllBtn = document.getElementById('openAllBtn');
            const openAllIncludingBtn = document.getElementById('openAllIncludingBtn');
            const loadBtn = document.getElementById('loadBtn');
            const copyAllBtn = document.getElementById('copyAllBtn');

            openAllBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Membuka...';
            openAllBtn.disabled = true;
            openAllIncludingBtn.disabled = true;
            loadBtn.disabled = true;
            copyAllBtn.disabled = true;

            updateStatus(`Membuka ${allValidLinks.length} link baru dari semua kelompok...`);
            updateProgress(0, allValidLinks.length);

            await openLinksBatch(allValidLinks, (processed, total) => {
                updateProgress(processed, total);
            }, () => {
                updateStatus(`Berhasil membuka ${allValidLinks.length} link baru dari semua kelompok`, 'success');
                showNotification(`Berhasil membuka ${allValidLinks.length} link baru dari semua kelompok`, 'success');
                isProcessing = false;
                openAllBtn.innerHTML = '<i class="fas fa-rocket"></i> Buka Semua Link Baru';
                openAllBtn.disabled = false;
                openAllIncludingBtn.disabled = false;
                loadBtn.disabled = false;
                copyAllBtn.disabled = false;
            });
        }

        /**
         * Membuka semua link (termasuk yang sudah dibuka) dari semua grup
         */
        async function openAllIncludingOpened() {
            if (isProcessing) return;

            let allValidLinks = [];
            groups.forEach((group, gIndex) => {
                group.links.forEach(link => {
                    if (link.isValid && !link.isDuplicate) {
                        allValidLinks.push({
                            url: link.url,
                            groupIndex: gIndex,
                        });
                    }
                });
            });

            if (allValidLinks.length === 0) {
                updateStatus('Tidak ada link yang bisa dibuka', 'error');
                showNotification('Tidak ada link yang bisa dibuka', 'error');
                return;
            }

            isProcessing = true;
            const openAllBtn = document.getElementById('openAllBtn');
            const openAllIncludingBtn = document.getElementById('openAllIncludingBtn');
            const loadBtn = document.getElementById('loadBtn');
            const copyAllBtn = document.getElementById('copyAllBtn');

            openAllIncludingBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Membuka...';
            openAllIncludingBtn.disabled = true;
            openAllBtn.disabled = true;
            loadBtn.disabled = true;
            copyAllBtn.disabled = true;

            updateStatus(`Membuka ${allValidLinks.length} link dari semua kelompok (termasuk yang sudah dibuka)...`);
            updateProgress(0, allValidLinks.length);

            await openLinksBatch(allValidLinks, (processed, total) => {
                updateProgress(processed, total);
            }, () => {
                updateStatus(`Berhasil membuka ${allValidLinks.length} link dari semua kelompok`, 'success');
                showNotification(`Berhasil membuka ${allValidLinks.length} link dari semua kelompok`, 'success');
                isProcessing = false;
                openAllIncludingBtn.innerHTML = '<i class="fas fa-play-circle"></i> Buka Semua Link';
                openAllBtn.innerHTML = '<i class="fas fa-rocket"></i> Buka Semua Link Baru';
                openAllIncludingBtn.disabled = false;
                openAllBtn.disabled = false;
                loadBtn.disabled = false;
                copyAllBtn.disabled = false;
            });
        }

        // ========== FUNGSI LAINNYA (COPY, SINGLE OPEN) ==========

        window.openSingleLink = function(groupIndex, linkIndex) {
            const link = groups[groupIndex].links[linkIndex];

            if (link.isDuplicate || !link.isValid) return;

            try {
                const hiddenIframe = document.getElementById('hiddenIframe');
                hiddenIframe.src = link.url;

                setTimeout(() => {
                    window.open(link.url, '_blank', 'noopener,noreferrer');
                }, 10);

                if (!link.opened) {
                    link.opened = true;
                }
                link.lastOpened = new Date().toISOString();
                
                updateStats();
                displayGroups();
                updateStatus(`Link dibuka: ${link.url.substring(0, 50)}...`, 'success');
            } catch (error) {
                updateStatus('Gagal membuka link', 'error');
                showNotification('Gagal membuka link', 'error');
            }
        };

        window.copyLink = function(groupIndex, linkIndex, buttonElement) {
            const link = groups[groupIndex].links[linkIndex];

            if (buttonElement.getAttribute('data-copied') === 'true') {
                return;
            }

            navigator.clipboard.writeText(link.url)
                .then(() => {
                    buttonElement.classList.add('copied');
                    buttonElement.innerHTML = '<i class="fas fa-check"></i> Tercopy!';
                    buttonElement.setAttribute('data-copied', 'true');
                    buttonElement.disabled = true;

                    if (userIP) {
                        updateStatus(`Link berhasil disalin ke clipboard (IP: ${userIP})`, 'success');
                    } else {
                        updateStatus('Link berhasil disalin ke clipboard', 'success');
                    }

                    setTimeout(() => {
                        buttonElement.classList.remove('copied');
                        buttonElement.innerHTML = '<i class="fas fa-copy"></i> Salin';
                        buttonElement.setAttribute('data-copied', 'false');
                        buttonElement.disabled = false;
                    }, 2000);
                })
                .catch(() => {
                    updateStatus('Gagal menyalin link', 'error');
                    showNotification('Gagal menyalin link', 'error');
                });
        };

        window.copyGroupLinks = function(groupIndex) {
            const group = groups[groupIndex];
            const validLinks = group.links.filter(l => l.isValid && !l.isDuplicate);

            if (validLinks.length === 0) {
                updateStatus(`Tidak ada link yang bisa disalin di kelompok "${group.title}"`, 'error');
                showNotification(`Tidak ada link yang bisa disalin di kelompok "${group.title}"`, 'error');
                return;
            }

            const linksText = validLinks.map(l => l.url).join('\n');
            const buttonElement = event.target.closest('button');
            
            const originalHTML = buttonElement.innerHTML;

            navigator.clipboard.writeText(linksText)
                .then(() => {
                    buttonElement.classList.add('copied');
                    buttonElement.innerHTML = '<i class="fas fa-check"></i> Tercopy!';
                    buttonElement.disabled = true;

                    if (userIP) {
                        updateStatus(`${validLinks.length} link dari "${group.title}" berhasil disalin (IP: ${userIP})`, 'success');
                    } else {
                        updateStatus(`${validLinks.length} link dari "${group.title}" berhasil disalin`, 'success');
                    }

                    setTimeout(() => {
                        buttonElement.classList.remove('copied');
                        buttonElement.innerHTML = originalHTML;
                        buttonElement.disabled = false;
                    }, 2000);
                })
                .catch(() => {
                    updateStatus('Gagal menyalin link', 'error');
                    showNotification('Gagal menyalin link', 'error');
                });
        };

        function copyAllLinks() {
            let allValidLinks = [];
            groups.forEach(group => {
                const validLinks = group.links.filter(l => l.isValid && !l.isDuplicate);
                allValidLinks = allValidLinks.concat(validLinks);
            });

            if (allValidLinks.length === 0) {
                updateStatus('Tidak ada link yang bisa disalin', 'error');
                showNotification('Tidak ada link yang bisa disalin', 'error');
                return;
            }

            const linksText = allValidLinks.map(l => l.url).join('\n');
            const buttonElement = document.getElementById('copyAllBtn');
            
            const originalHTML = buttonElement.innerHTML;

            navigator.clipboard.writeText(linksText)
                .then(() => {
                    buttonElement.classList.add('copied');
                    buttonElement.innerHTML = '<i class="fas fa-check"></i> Tercopy!';
                    buttonElement.disabled = true;

                    if (userIP) {
                        updateStatus(`${allValidLinks.length} link dari semua kelompok berhasil disalin (IP: ${userIP})`, 'success');
                    } else {
                        updateStatus(`${allValidLinks.length} link dari semua kelompok berhasil disalin`, 'success');
                    }

                    setTimeout(() => {
                        buttonElement.classList.remove('copied');
                        buttonElement.innerHTML = originalHTML;
                        buttonElement.disabled = false;
                    }, 2000);
                })
                .catch(() => {
                    updateStatus('Gagal menyalin link', 'error');
                    showNotification('Gagal menyalin link', 'error');
                });
        }

        // ========== SEARCH ==========
        const searchInput = document.getElementById('searchInput');
        const clearSearchBtn = document.getElementById('clearSearchBtn');

        function setupSearch() {
            if (!searchInput) return;

            searchInput.addEventListener('input', (e) => {
                const query = e.target.value.trim();
                
                if (query.length > 0) {
                    clearSearchBtn.style.display = 'flex';
                } else {
                    clearSearchBtn.style.display = 'none';
                }

                filterGroups(query);
            });

            clearSearchBtn.addEventListener('click', clearSearch);

            searchInput.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                }
            });
        }

        function filterGroups(query) {
            if (!query) {
                resetFilters();
                return;
            }

            const lowerQuery = query.toLowerCase();
            let matchCount = 0;

            const desktopGroups = document.querySelectorAll('.group-container');
            desktopGroups.forEach(groupElement => {
                const groupIndex = parseInt(groupElement.dataset.groupIndex);
                const groupData = groups[groupIndex];

                if (!groupData) return;

                const titleMatch = groupData.title.toLowerCase().includes(lowerQuery);
                let linkMatch = false;

                const links = groupElement.querySelectorAll('.links-table tbody tr');
                links.forEach((row, index) => {
                    const linkData = groupData.links[index];
                    if (linkData) {
                        const urlText = linkData.url.toLowerCase();
                        const isMatch = urlText.includes(lowerQuery);
                        
                        if (isMatch) linkMatch = true;

                        if (isMatch) {
                            row.style.background = 'rgba(108, 99, 255, 0.1)';
                        } else {
                            row.style.background = '';
                        }
                    }
                });

                if (titleMatch || linkMatch) {
                    groupElement.classList.remove('filtered-hidden');
                    groupElement.classList.add('force-expanded');
                    groupElement.classList.remove('minimized');
                    
                    const icon = groupElement.querySelector('.minimize-btn i');
                    if (icon) icon.className = 'fas fa-chevron-up';
                    
                    matchCount++;
                } else {
                    groupElement.classList.add('filtered-hidden');
                    groupElement.classList.remove('force-expanded');
                }
            });

            if (matchCount === 0) {
                updateStatus(`Tidak ditemukan hasil untuk "${query}"`, 'error');
            } else {
                updateStatus(`Ditemukan ${matchCount} kelompok cocok dengan "${query}"`, 'success');
            }
        }

        function clearSearch() {
            if (searchInput) {
                searchInput.value = '';
                clearSearchBtn.style.display = 'none';
            }
            resetFilters();
            searchInput.focus();
        }

        function resetFilters() {
            const desktopGroups = document.querySelectorAll('.group-container');
            desktopGroups.forEach(group => {
                group.classList.remove('filtered-hidden');
                group.classList.remove('force-expanded');
                
                const rows = group.querySelectorAll('.links-table tbody tr');
                rows.forEach(row => row.style.background = '');
            });

            updateStatus('Pencarian direset', 'info');
        }

        // ========== MONITOR KONEKSI ==========
        function monitorConnection() {
            window.addEventListener('online', () => {
                isOnline = true;
                updateConnectionStatus('online', 'Online');
                showNotification('Koneksi internet tersambung kembali', 'success');
                
                if (!isProcessing) {
                    loadData();
                }
            });

            window.addEventListener('offline', () => {
                isOnline = false;
                updateConnectionStatus('offline', 'Offline');
                showNotification('Koneksi internet terputus', 'error');
            });
        }

        // ========== INISIALISASI ==========
        window.addEventListener('DOMContentLoaded', async () => {
            setupSearch();
            monitorConnection();
            getIPInfo();
            
            const loadTimeout = setTimeout(() => {
                if (document.getElementById('loading').style.display === 'block') {
                    updateStatus('Loading terlalu lama. Mencoba metode alternatif...', 'error');
                    showNotification('Loading terlalu lama. Mencoba metode alternatif...', 'error');
                    loadData();
                }
            }, 15000);
            
            loadData().finally(() => {
                clearTimeout(loadTimeout);
            });
        });

        window.addEventListener('beforeunload', () => {
            if (openAllTimeout) clearTimeout(openAllTimeout);
        });

        document.addEventListener('visibilitychange', () => {
            if (document.hidden) {
                console.log('Page is hidden, pausing operations');
            } else {
                const now = new Date().getTime();
                if (lastDataLoadTime && (now - lastDataLoadTime > cacheExpiryTime)) {
                    console.log('Data might be expired');
                }
            }
        });
    </script>
</body>
</html>


